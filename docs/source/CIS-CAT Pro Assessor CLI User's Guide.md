![](http://i.imgur.com/5yZfZi5.jpg)

# CIS-CAT Pro Assessor CLI User's Guide #

## Introduction ##
The CIS-CAT Pro Assessor CLI is a command-line user interface, allowing users to assess target systems against various forms of machine-readable content.  CIS-CAT Pro Assessor CLI is designed primarily to assess CIS Benchmark configuration recommendations but can also assess content written in conformance with the Security Content Automation Protocol (SCAP), as well as plain OVAL definition content.

## Deployment ##
CIS-CAT Pro Assessor CLI is a simple Java-based application and as such, requires a Java Runtime Environment (JRE) at or above version 1.8, in order to execute.  A suitable JRE may be installed to the machine on which CIS-CAT is installed, or may be located on a network share.  As long as the machine executing the CIS-CAT Pro Assessor CLI application can access a suitable JRE, it may be used to run the tool.

## Using CIS-CAT Pro Assessor CLI ##

### Command Line Options ###
CIS-CAT Pro Assessor CLI can perform a variety of functions related to both benchmark and vulnerability assessments.  The myriad command-line options allow for combined usage to initiate these functions.

#### Basic Options ####
| Short Option  | Long Option   | Description                                     |
| ------------- | ------------- | ----------------------------------------------- |
| `-h`          | `--help`      | Display CIS-CAT Pro Assessor help output. |
| `-l`          | `--list`      | List the benchmarks available for assessment.|
| `-i`          | `--interactive` | Execute the Assessor in "interactive" mode specifically for benchmark assessments, allowing the user to manually select a benchmark and profile for assessment.  Based on the selected benchmark, the user may be required to enter "interactive values" which are then used by the assessment engine. |
| `-o`          | `--definitions` | Execute the Assessor in "interactive" mode specifically for the manual selection and evaluation of OVAL Definitions files, and (optionally) selecting and associating an OVAL Variables file as well.|


	-h, --help
Display CIS-CAT Pro Assessor help output.

	-l, --list
List the benchmarks available for assessment.

	-i, --interactive
Execute the Assessor in "interactive" mode specifically for benchmark assessments, allowing the user to manually select a benchmark and profile for assessment.  Based on the selected benchmark, the user may be required to enter "interactive values" which are then used by the assessment engine.

	-o, --definitions
Execute the Assessor in "interactive" mode specifically for the manual selection and evaluation of OVAL Definitions files, and (optionally) selecting and associating an OVAL Variables file as well.

#### Report Configuration Options ####
	-d, --startingDir
Configure the Assessor's starting directory.  When not used, the starting directory defaults to the folder location of the main Assessor .jar file.

	-rd, --reports-dir
Configure the report destination folder, allowing users to configure the location to which result reports are written.

	-rp, --report-prefix
Configure the "front" portion of the report name generated by the tool.  Every report will automatically be of the format `[report-prefix]-[timestamp].[extension]` such as `CIS-CAT-TEST-Windows10-20171218T173220Z.xml`.

#### Benchmark/Data-Stream Collection Options ####
	-b, --benchmark <BENCHMARK> 
Specify either the full filepath to a benchmark XML file (an XCCDF), or a path relative to the starting directory.

	-ds, --data-stream <DATA-STREAM>
Specify either the full filepath to a data-stream collection XML file, or a path relative to the starting directory.

	-cl, --checklist <CHECKLIST>
Used only in conjunction with the `-ds` option, the `-cl` option specifies, within the data-stream collection, the ID of the checklist (benchmark) to be assessed.

	-p, --profile <PROFILE>
Specify either a profile name, such as `Level-1`, or the profile ID, such as `xccdf_org.cisecurity.benchmarks_profile_Level_1`.

#### OVAL Definitions Assessment Options #####
	-od, --oval-definitions <OVAL_DEFINITIONS>
Specify either the full filepath to an OVAL Definitions XML file, or a path relative to the starting directory.

	-ov, --oval-variables <OVAL_VARIABLES>
Only used in conjunction with the `-od` option, the `-ov` option specifies either the full filepath to an OVAL Variables XML file, or a path relative to the starting directory.

#### Report Generation Options ####
	-u, --url <REPORTS-URL>
Specify a URL to which Assessor results are uploaded, using HTTP(S) POST.

	-ui, --ignore-warnings
Indicate that, when uploading results to a URL via the `-u` option, any SSL certificate warnings should be ignored.

	-nrf, --no-report-file
This option disables generation of a results report file.  When utilizing the `-u` option, Assessor results are uploaded to the supplied URL.  In that use-case, report files are generally not needed.  

#### Extra configuration Options ####

	-sessions, --sessions <SESSIONS.PROPERTIES>
The `-sessions` option allows users to configure multiple endpoints for assessment of a benchmark.  The `sessions.properties` file configures CIS-CAT Pro Assessor for the assessment of remote endpoints by specifying remote hosts, ports, and credentials which the application will use for connection, collection and evaluation of benchmark recommendations and/or vulnerabilities.  See "Remote Assessment Capability" below for more information.

If no `sessions.properties` file exists or no connections are configured in the file, CIS-CAT Pro Assessor CLI will assess the local machine.

	-props, --properties <PROPERTIES-FILE>
The CIS-CAT Pro Assessor CLI user properties file defaults many runtime properties used during the assessment process.  These properties may be customized per assessment or per endpoint, by creating individual properties files, and specifying either the full filepath or a path relative to the working directory.

	-D <Property=Value>
Instead of creating a new properties file for unique assessments, individual user properties may be specified using the `-D` option together with a `property=value` pair.  This allows an assessment to only override specific user properties when only a small number differ from the defaults.

#### Debugging Options ####
	-v, --verbose
Enable more verbose output when combined with the `-l` option.

----------

### Remote Assessment Capability ####

### Producing Reports ###

### Examples ###
The following are common examples for executing CIS-CAT Pro Assessor CLI.  Note the `>` indicates a command prompt.
#### List All Available Benchmarks ####
    > java -Xmx768m -jar Assessor-CLI-1.0.0.jar -l

#### List All Available Benchmarks (with `-b` information)
    > java -Xmx768m -jar Assessor-CLI-1.0.0.jar -l -v

#### Execute interactively against the local host ####
    > java -Xmx768m -jar Assessor-CLI-1.0.0.jar -i

#### Configure Sessions ####
    > java -Xmx768m -jar Assessor-CLI-1.0.0.jar -sessions config\windows.properties

#### Assess a specific benchmark and profile ####
    > java -Xmx768m -jar Assessor-CLI-1.0.0.jar -b benchmarks\CIS_Microsoft_Windows_10_Enterprise_Release_1703_Benchmark_v1.3.0-xccdf.xml -p "Level 1"

#### Download Vulnerability Definitions ####
    > java -Xmx768m -jar Assessor-CLI-1.0.0.jar -vdd

#### Execute a Vulnerability Assessment ####
    > java -Xmx768m -jar Assessor-CLI-1.0.0.jar -od vulnerabilities\microsoft_windows_10.xml

