{"config":{"lang":["en"],"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"Please choose the guide you would like to view on the menu to the left.","title":"Home"},{"location":"CHANGELOG/","text":"Change Log NOTE: CIS-CAT Pro Assessor v4 is currently in BETA and this documentation will change as a result of ongoing testing and feedback. Until the official release of CIS-CAT Pro Assessor v4, please consider this document fluid. CIS-CAT Pro Assessor v4.0.0 See the CIS-CAT Pro Assessor Coverage Guide for information about supported benchmarks, OVAL schemas/test types, and scripting capabilities. Benchmark Updates N/A for the initial release Assessor Updates This is the initial release of CIS-CAT Pro Assessor v4 (CCPA), a command-line user interface enabling configuration and vulnerability assessment of endpoints. Major features included in this initial release are: Assessment of the system from which the Assessor is invoked. This functionality mimics the host-based assessments from CIS-CAT v3. Assessment of remote Windows endpoints using WinRM and an \"ephemeral\" agent. Assessment of remote Unix/Linux endpoints using an SSH-based connection. Assessment of Cisco IOS network devices using an SSH-based connection. Support for the assessment of Security Content Automation Protocol (SCAP) 1.2 data-stream collections. Support for the assessment of XCCDF 1.2-based content. Support for the assessment of OVAL Definitions files, such as inventory and vulnerability definitions. Support for multiple report formats, such as the Asset Reporting Format and OVAL Results with System Characteristics in XML format, as well as HTML, CSV, or plain-text formats. Support for the upload of assessment results to CIS-CAT Pro Dashboard.","title":"Change Log"},{"location":"CHANGELOG/#change-log","text":"NOTE: CIS-CAT Pro Assessor v4 is currently in BETA and this documentation will change as a result of ongoing testing and feedback. Until the official release of CIS-CAT Pro Assessor v4, please consider this document fluid.","title":"Change Log"},{"location":"CHANGELOG/#cis-cat-pro-assessor-v400","text":"See the CIS-CAT Pro Assessor Coverage Guide for information about supported benchmarks, OVAL schemas/test types, and scripting capabilities.","title":"CIS-CAT Pro Assessor v4.0.0"},{"location":"CHANGELOG/#benchmark-updates","text":"N/A for the initial release","title":"Benchmark Updates"},{"location":"CHANGELOG/#assessor-updates","text":"This is the initial release of CIS-CAT Pro Assessor v4 (CCPA), a command-line user interface enabling configuration and vulnerability assessment of endpoints. Major features included in this initial release are: Assessment of the system from which the Assessor is invoked. This functionality mimics the host-based assessments from CIS-CAT v3. Assessment of remote Windows endpoints using WinRM and an \"ephemeral\" agent. Assessment of remote Unix/Linux endpoints using an SSH-based connection. Assessment of Cisco IOS network devices using an SSH-based connection. Support for the assessment of Security Content Automation Protocol (SCAP) 1.2 data-stream collections. Support for the assessment of XCCDF 1.2-based content. Support for the assessment of OVAL Definitions files, such as inventory and vulnerability definitions. Support for multiple report formats, such as the Asset Reporting Format and OVAL Results with System Characteristics in XML format, as well as HTML, CSV, or plain-text formats. Support for the upload of assessment results to CIS-CAT Pro Dashboard.","title":"Assessor Updates"},{"location":"ConfigurationGuide/","text":"CIS-CAT Pro Assessor Configuration Guide NOTE: CIS-CAT Pro Assessor v4 is currently in BETA and this documentation will change as a result of ongoing testing and feedback. Until the official release of CIS-CAT Pro Assessor v4, please consider this document fluid. Introduction Utilizing the CIS-CAT Pro Assessor CLI, users are capable of performing both host-based (local) assessments, as well as remote-based assessments. In order to perform assessments of remote endpoints, certain configurations must be made. The intent of this document is to serve as a guide for enabling systems for remote-based assessments using CIS-CAT Pro Assessor. Sessions CIS-CAT Pro Assessor v4's remote assessment capability depends on the configuration of \"sessions\"; connection parameters used to create a secure connection to the remote endpoint. A session configuration requires a number of entries, which will vary depending on the connection type. Connection Types A number of different connection types exist to allow for maximum flexibility and coverage for the assessment of various endpoints, ranging from the local host to remote Windows, Unix, Linux, and Apple OSX endpoints, as well as Cisco network devices. Type Value Description Local local Usage of a \"local\" session is for a host-based assessment, mimicing the functionality of CIS-CAT Pro v3. Standalone or command-line applications (such as CIS-CAT Pro Assessor CLI) may use the local session to continue host-based assessments of benchmarks and/or OVAL definitions. SSH (Unix, Linux, Apple OSX) ssh The \"ssh\" session type represents a connection to a remote Unix, Linux, or Apple OSX endpoint, via SSH (obviously). SSH connections can be established a number of different ways, including username/password , username/path to a private key file , username/private key file protected with a passphrase , username/private key file + credentials to use for sudo . Windows windows The \"windows\" session type represents a WinRM connection to a remote Microsoft Windows environment. Both workstations and servers are supported with this connection type and can currently be established using username/password authentication. Cisco IOS ios The \"ios\" session type handles the specific case for the assessment of Cisco IOS network devices. Depending on the specific configuration when the \"ios\" session type is used, CIS-CAT Pro Assessor will either establish a SSH connection using username/password or username/path to a private key authentication, or will create a modified local session, collecting information from an exported configuration file. Cisco ASA asa The \"asa\" session type handles the specific case for the assessment of Cisco ASA devices. Depending on the specific configuration when the \"asa\" session type is used, CIS-CAT Pro Assessor will either establish a SSH connection using username/password or username/path to a private key authentication, or will create a modified local session, collecting information from an exported configuration file. Configuration Properties A number of configuration properties exist, and will vary based on the session type. Property Description type The type property MUST be configured to one of the connection types specified above ( local , ssh , windows , ios , or asa ). host The host property is required for any remote connection, and can be either the hostname or IP address (v4 or v6) of the endpoint to be assessed. Examples include 1.2.3.4 or CIS-CAT-TEST . The host property is not needed when assessing against exported network device configuration files. The host property is not needed when the session type is local . port The port property is required for any remote connection. When using the ssh connection type, the default value for the port property would be 22 . When using the windows connection type, the defaut WinRM ports are 5985 for HTTP and 5986 for HTTPS. The port property is not needed when assessing against exported network device configuration files. The port property is not needed when the session type is local . user The user property represents an administrator-level username, used to log on to the remote endpoint. This can be a domain user or a local administrator on the remote endpoint, or a privileged user when logging on to Cisco network devices. The user property is not needed when assessing against exported network device configuration files. The user property is not needed when the session type is local . cred The cred property represents the credentials for the user , in order to log on to the remote endpoint. Note that this is not encrypted, so users must take great care in safeguarding the sessions configuration file(s). NOTE : When executing CIS-CAT Pro Assessor CLI, if a given session's configuration specifies neither the cred nor the identity property, the user will be prompted to enter credentials manually. This will block assessment against other configured sessions until credentials are entered. The cred property is not needed when assessing against exported network device configuration files. The cred property is not needed when the session type is local . identity The identity property represents the full path to a private key file used for authentication to a remote endpoint. NOTE : When executing CIS-CAT Pro Assessor CLI, if a given session's configuration specifies neither the cred nor the identity property, the user will be prompted to enter credentials manually. This will block assessment against other configured sessions until credentials are entered. The identity property is not needed when assessing against exported network device configuration files. The identity property is not needed when the session type is local . identityPassphrase The identityPassphrase property is optional and should be used in conjunction with the identity property, when that key is protected with a passphrase. enable The enable property is used only in network device sessions ( ios or asa ) and represents the credentials needed to enter \"privileged EXEC\" mode; required for obtaining the full output of the show tech-support command. The enable property is not needed when assessing against exported network device configuration files. The enable property is not needed when the session type is local . tech The tech property is REQUIRED when assessing the exported configuration of a network device. This property specifies the full path to the exported configuration file. When assessing non-network device endpoints, or assessing a network devices' current running configuration via SSH, the tech property is unnecessary. The tech property is not needed when the session type is local . tmp The tmp property allows users to configure the location of the temporary \"ephemeral\" directory on the target host. This \"ephemeral\" directory is created upon connection to the target endpoint, hosts any scripts which may require executing during system characteristics collection, and is deleted upon the Assessor's completion and session disconnect. If this property is left blank or not included, the Assessor will use the default \"temp\" folder as defined for the operating system, such as /tmp or C:\\Windows\\Temp . Examples The examples below provide insight into the creation of a sessions.properties file, which can then be consumed by CIS-CAT Pro Assessor CLI to provide connection configurations when assessing a particular benchmark. By default, CIS-CAT Pro Assessor CLI will ALWAYS attempt to load a default configuration file located in the application's config folder, named sessions.properties . For example, if CCPA is installed at C:\\CIS\\Assessor-CLI , a file named C:\\CIS\\Assessor-CLI\\config\\sessions.properties will be searched for and loaded (if found). If no sessions.properties files are found or specified, a default local session will be used. Configure a session for the local host, defining a custom \"temp\" folder: session.1.type=local # Note that specifying Windows directory paths require a double-backslash \"\\\\\" as the path separator session.1.tmp=C:\\\\Temp Configure a remote Windows session using a username/password: session.2.type=windows session.2.host=123.255.198.9 session.2.port=5986 session.2.user=Administrator1 session.2.cred=s3cr3t3r! Configure a remote Windows session using a username, but requiring manual password entry: session.3.type=windows session.3.host=100.50.25.75 session.3.port=5986 session.3.user=Administrator1 Configure a remote Linux session using a username/password, defining a custom \"temp\" folder: session.4.type=ssh session.4.host=ubuntu-test.example.org session.4.port=22 session.4.user=ubuntu session.4.cred=s3cr3t3r! session.4.tmp=/home/ubuntu Configure a remote Linux session using a username/private key: session.5.type=ssh session.5.host=ubuntu-test.example.org session.5.port=22 session.5.user=ubuntu session.5.identity=/home/ubuntu/cis/ubuntu-test.ppk Configure a remote Linux session using a username/private key, with the private key being secured with a passphrase: session.6.type=ssh session.6.host=ubuntu-test.example.org session.6.port=22 session.6.user=ubuntu session.6.identity=/home/ubuntu/cis/ubuntu-test.ppk session.6.identityPassphrase=P@55phr@s3! Configure a remote Cisco IOS session using a username/password: session.7.type=ios session.7.host=9.8.7.6 session.7.port=22 session.7.user=admin session.7.cred=s3cr3t3r! session.7.enable=3nab!3d Configure a remote Cisco IOS session using a username/private key: session.8.type=ios session.8.host=9.8.7.6 session.8.port=22 session.8.user=admin # Note that specifying Windows directory paths require a double-backslash \"\\\\\" as the path separator session.8.identity=C:\\\\CIS\\\\cisco-ios.ppk session.8.enable=3nab!3d Configure a Cisco IOS session pointing to an exported configuration file: session.9.type=ios # Note that specifying Windows directory paths require a double-backslash \"\\\\\" as the path separator session.9.tech=C:\\\\CIS\\\\TS\\\\tech-support-export.txt Microsoft Windows Endpoint Configuration CIS-CAT Pro Assessor v4 utilizes the prevalent SMB protocol for file manipulation and uses WinRM for process execution. Once connected to a remote Windows endpoint, CIS-CAT Pro Assessor establishes an \"ephemeral\" directory to host script required for the collection of system characteristics from the endpoint. Once the collection/assessment has completed and the session disconnected, the \"ephemeral\" directory is removed from the endpoint. CIS-CAT Pro Assessor v4 supports both basic authentication for local accounts and Kerberos authentication for domain accounts. When authenticating with domain accounts, the new-style domain syntax, e.g. ciscatuser@example.org must be used, and NOT the old-style domain syntax, such as DOMAIN\\User . The Assessor will access the administrative shares on the remote host, which are only accessible for users that are part of the Administrators on the remote host. Security Considerations The majority of CIS benchmarks for Microsoft Windows operating systems contain recommendations restricting WinRM usage. The following table indicates those restrictions which will need to be relaxed in order to enable remote assessment in CIS-CAT Pro Assessor. Recommendation CIS Benchmark Value Relaxed Value 18.6.1: Ensure 'Apply UAC restrictions to local accounts on network logons' is set to 'Enabled' Enabled Disabled WinRM Configuration In order for CIS-CAT Pro Assessor to connect to a remote Windows host, a number of configuration steps on those hosts must happen. The following sections will describe the configurations. Windows Firewall Configuration CIS-CAT Pro Assessor v4 uses both the SMB and WinRM protocols in order to enable file manipulation and process execution, respectively. As such, to connect to the remote host using SMB, ensure the host is reachable on port 445 . To enable connection to the remote host using WinRM over HTTPS, ensure the host is reachable on port 5986 . Users can enable these firewall rules simply using PowerShell and the script provided with the CIS-CAT Pro Assessor v4 application bundle. The bundle will contain a setup folder, in which will be locate the CISCAT_Pro_Assessor_v4_Firewall_SMB_WinRM.ps1 script. Execute this script in PowerShell to configure the Windows Firewall. Enable WinRM On the remote Windows host, open a Command Prompt using the \"Run as Administrator\" option. Enter the following command to enable the default configuration for WinRM: winrm quickconfig A confirmation prompt may be presented to the user. If so, type Y and hit Enter . Performing the quickconfig will start the Windows Remote Management service, configure an HTTP listener and create exceptions in the Windows Firewall for the WinRM service. If users intend to connect to remote endpoints using WinRM over HTTP (and not HTTPS), then WinRM must be configured to \"Allow unencrypted traffic\": winrm set winrm/config/service @{AllowUnencrypted=\"true\"} By default, Kerberos authentication is enabled in WinRM. Disable it if CIS-CAT Pro Assessor will NOT be authenticating using domain accounts: winrm set winrm/config/service/Auth @{Kerberos=\"false\"} NOTE : Do not disable \"Negotiate\" authentication as the winrm command itself uses that to configure the WinRM subsystem. Finally, configure WinRM to provide enough memory to the commands that are going to be executed, e.g. 1024 MB: winrm set winrm/config/winrs @{MaxMemoryPerShellMB=\"1024\"} Configure WinRM over HTTPS In order for CIS-CAT Pro Assessor to access the remote Windows host using WinRM over HTTPS, an HTTPS WinRM Listener must be configured using the thumbprint of a certificate for that host. Users can attempt to find an existing certificate thumbprint for the remote host using PowerShell. In the following commands, assume HOSTNAME is the DNS name of the remote Windows host: PS C:\\Windows\\system32 Get-childItem cert:\\LocalMachine\\Root\\ | Select-String -pattern HOSTNAME If a certificate exists on the system, the PowerShell command will yield results similar to the following: [Subject] CN=HOSTNAME [Issuer] CN=HOSTNAME [Serial Number] 527E7AF9142D96AD49A10469A264E766 [Not Before] 5/23/2011 10:23:33 AM [Not After] 5/20/2021 10:23:33 AM [Thumbprint] 5C36B638BC31F505EF7F693D9A60C01551DD486F Once the certificate thumbprint is found, create the HTTPS WinRM listener for the remote host: winrm create winrm/config/Listener?Address=*+Transport=HTTPS @{Hostname=\"HOSTNAME\"; CertificateThumbprint=\"THUMBPRINT\"} Where HOSTNAME is the DNS name of the remote host, such as WINSERVER1 , and THUMBPRINT is the certificate thumbprint found in PowerShell, for example 5C36B638BC31F505EF7F693D9A60C01551DD486F If no results are returned, the user may create a self-signed certificate using PowerShell and a script provided with the CIS-CAT Pro Assessor v4 application bundle. The bundle will contain a setup folder, in which will be located the CISCAT_Pro_Assessor_v4_SelfSignedCertificate.ps1 script. Execute this script in PowerShell to configure the self-signed certificate and create the WinRM HTTPS listener. Disable UAC remote restrictions To better protect those users who are members of the local Administrators group, Microsoft implemented UAC restrictions on the network. This mechanism helps prevent against \"loopback\" attacks. This mechanism also helps prevent local malicious software from running remotely with administrative rights. When a user who is a member of the local administrators group on the target remote computer establishes a remote administrative connection by using the net use * \\\\remotecomputer\\Share$ command, for example, they will not connect as a full administrator. The user has no elevation potential on the remote computer, and the user cannot perform administrative tasks. If the user wants to administer the workstation with a Security Account Manager (SAM) account, the user must interactively log on to the computer that is to be administered with Remote Assistance or Remote Desktop, if these services are available. To disable UAC remote restrictions, follow these steps: Click Start, click Run, type regedit , and then press ENTER . Locate and then click the following registry subkey: HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System If the LocalAccountTokenFilterPolicy registry entry does not exist, follow these steps: On the Edit menu, point to New , and then click DWORD Value . Type LocalAccountTokenFilterPolicy , and then press ENTER . Right-click LocalAccountTokenFilterPolicy , and then click Modify . In the Value data box, type 1 , and then click OK . Exit Registry Editor. In Windows domain environments, this setting can be configured through Group Policy, however, the Group Policy Object is not a standard policy and must be downloaded and installed separately. Generally, if an environment has installed the Microsoft Security Compliance Manager (SCM), the GPO is included there and can be exported. Otherwise, the Group Policy Objects can be found either here or here . Domain Considerations If users are planning on authenticating to remote Windows hosts using domain accounts, configuration is necessary both on the remote host, and on the \"source\" host (the machine hosting CIS-CAT Pro Assessor v4). Kerberos - Source Host Depending on the operating system of the source hose, create a file called krb5.conf (Unix) or krb5.ini (Windows) with at least the following content: [realms] EXAMPLE.ORG = { kdc = KDC.EXAMPLE.ORG } Replace the values with the name of your domain/realm and the hostname of your domain controller (multiple entries can be added to allow the source host to connect to multiple domains) and place the file in the default location for your operating system: Linux: /etc/krb5.conf Solaris: /etc/krb5/krb5.conf Windows: C:\\Windows\\krb5.ini Kerberos - Remote Host By default, the CIS-CAT Pro Assessor's connection to a remote Windows host will request access to a Kerberos service principal name of the form WSMAN/HOST . This SPN should be configured automatically when configuring WinRM for the remote host (the \"Enable WinRM\" section above). To verify the SPN has been created, list all the SPNs configured on the remote host: setspn -L HOSTNAME If the WSMAN/HOSTNAME SPN is not listed, it must be configured. From any host in the domain, invoke the setspn command: setspn -A WSMAN/ADDRESS HOSTNAME Where ADDRESS is the address (DNS Name or IP Address) used to connect to the remote host, and HOSTNAME is the short Windows hostname of the remote host. Unix/Linux/OSX Endpoint Configuration CIS-CAT Pro Assessor assesses remote Unix/Linux/OSX targets via SSH connections. Ensure the target system can be accessed via SSH and that the user connecting to the remote target is either the root user or a user granted privileges to execute commands using sudo . Cisco Network Device Endpoint Configuration CIS-CAT Pro Assessor v4 can assess either the current running configuration of a Cisco network device, or an exported configuration file. Connecting to a Device CIS-CAT Pro Assessor assesses Cisco network device targets via SSH connections. Ensure the target system can be accessed via SSH and that the user connecting to the remote target is a privileged user. When connecting to Cisco devices, CIS-CAT Pro Assessor will be configured to enter \"privileged EXEC\" mode, so any user connecting to the Cisco device via SSH must be granted appropriate permission to do so. Exported Configuration File CIS-CAT Pro Assessor can also assess an exported configuration file; the output of the show tech-support command. The output from the show tech-support command is very long. To better manage this output, you can redirect the output to a file (for example, show tech-support *filename* ) in the local writable storage file system or the remote file system. You can use one of the following redirection methods: filename \u2014Redirects the output to a file. filename \u2014Redirects the output to a file in append mode. This example shows how to redirect the technical support information to a file: switch# show tech-support bootflash:TechSupport.txt Once the exported configuration file is available to CIS-CAT Pro Assessor, the assessment can be performed against it. See the example above entitled \"Configure a Cisco IOS session pointing to an exported configuration file\" to configure the appropriate Assessor \"session\". Database Endpoint Configuration Assessing database benchmarks in CIS-CAT Pro Assessor v4 uses the same JDBC connection mechanism as previous versions. Database benchmarks will require a user to enter the JDBC connection string, or utilize the ciscat.properties file to set the appropriate value for assessment. Oracle Database The JDBC string parameter is the connection string used to connect to and authenticate to the Oracle Database service and instance that CIS-CAT will assess. The Oracle JDBC driver has the ability to connect to Oracle database instances using either the SID or Service Name. When connecting to an Oracle database using the SID, the format of the JDBC connection string is: jdbc:oracle:thin:[username]/[password]@[hostname]:[port]:[SID] For example: jdbc:oracle:thin:sys as sysdba/pa55w0rd!@servername:1521:ORCL When connecting to an Oracle database using the Service Name, the format of the JDBC connection string is: jdbc:oracle:thin:[username]/[password]@//[hostname]:[port]/[service_name] For example: jdbc:oracle:thin:sys as sysdba/pa55w0rd!@//servername:1521/SERVICE_NAME The following table describes the components of the Oracle JDBC connection string. Property Name Property Description username A valid username who can connect to the database instance. This user should have sufficient privileges to SELECT from the various tables and views indicated in the specific Oracle benchmark, or be granted SYSDBA privileges. password The credentials for the specified username to connect to the database instance. hostname The name of the server (or it's IP address) hosting the database. port The port number on which the database is listening. By default, Oracle databases are configured to listen on port 1521. SID The database SID. Service Name The database Service Name. Oracle MySQL Database Oracle MySQL database support is implemented using the MariaDB JDBC driver. The format for the MariaDB JDBC connection string for MySQL is: jdbc:mysql:// host : port / database ? key1 = value1 key2 = value2 ... Consider a MySQL database instance with the following information: Property Name Property Value Server Name CIS-SERVER Database Name TestDB Database Port 3306 Username db_user Credentials db_pass When configuring the JDBC connection string in CIS-CAT Pro Assessor, the above information would yield: jdbc:mysql://CIS-SERVER:3306/TestDB?user=db_user password=db_pass Notable optional parameters involve ensuring JDBC connections are made via SSL: Property Name Property Description user The database username. password The credentials for the specified user to connect to the database instance. useSSL Force the usage of SSL on the connection. trustServerCertificate When using SSL, do not verify the server's certificate. serverSslCert Server's certificate in DER form, or server's CA certificate. Can be used in one of 3 forms: serverSslCert=/path/to/cert.pem : full path to certificate serverSslCert =classpath:relative/cert.pem : relative to current classpath or as verbatim DER-encoded certificate string, starting with ------BEGIN CERTIFICATE----- NOTES The default port number for MySQL is 3306 The full set of connection properties/optional URL parameters supported by MariaDB can be found at https://mariadb.com/kb/en/mariadb/about-the-mariadb-java-client/ PostgreSQL Database CIS-CAT Pro Assessor has implemented support for assessments against PostgreSQL database instances using the PostgreSQL JDBC driver. The format for the PostgreSQL JDBC connection string is: jdbc:postgresql:// host : port / database ? key1 = value1 key2 = value2 ... Consider a PostgreSQL database instance with the following information: Property Name Property Value Server Name CIS-POSTGRESQL Database Name PostgreSQL-DB Database Port 5432 (the default) Username db_user Credentials db_pass When configuring the JDBC connection string in CIS-CAT Pro Assessor, the above information would yield: jdbc:postgresql://CIS-POSTGRESQL:5432/PostgreSQL-DB?user=db_user password=db_pass If CIS-CAT Pro Assessor is connecting to PostgreSQL on the default port (5432), it can be omitted from the connection string: jdbc:postgresql://CIS-POSTGRESQL/PostgreSQL-DB?user=db_user password=db_pass Notable optional parameters involve ensuring JDBC connections are made via SSL: Property Name Property Description user The database username. password The credentials for the specified user to connect to the database instance. ssl A boolean value ( true or false ), to force the usage of SSL on the connection. For example, in order to force the database connection to require SSL, the connection string would look like: jdbc:postgresql://CIS-POSTGRESQL/PostgreSQL-DB?user=db_user password=db_pass ssl=true NOTES The default port number for PostgreSQL is 5432 The full set of connection properties/optional URL parameters supported by PostgreSQL can be found at https://jdbc.postgresql.org/documentation/head/connect.html Microsoft SQL Server Microsoft SQL Server database support is implemented using the jTDS open source JDBC driver. The jTDS driver provides support for SQL Server 6.5, 7, 2000, 2005, 2008, and 2012. The format of the jTDS JDBC URL for MS SQL Server is: jdbc:jtds:sqlserver:// server [: port ][/ database ][; property = value ] Properties required for the database connection can be provided as property = value pairs, separated by a semi-colon ; Consider a Microsoft SQL Server database instance with the following information: Property Name Property Value Server Name CIS-SERVER Database Name TestDB Database Port 1433 Windows Domain WIN-DOMAIN Windows Domain User/Password jsmith/qw3rty SQL Server Database User/Password db_user/db_pass Instance Name InstanceName Windows Authentication Windows Authentication Mode allows a user to connect to a SQL Server instance through a Microsoft Windows user account. This mode allows domain user account information to be supplied in order to establish a connection. The following JDBC connection string would be valid for establishing a connection using the above example information: jdbc:jtds:sqlserver://CIS-SERVER:1433/TestDB;domain=WIN-DOMAIN;user=jsmith;password=qw3rty;instance=InstanceName Windows Authentication Mode may also be used against databases running on machines not joined to a domain (standalone servers). When authenticating with Microsoft Windows user accounts to non-domain joined servers, substitute in the computer name for the domain. For example, if the name of the standalone server is SQLSERVER , the JDBC connection string would look as such: jdbc:jtds:sqlserver://CIS-SERVER:1433;DatabaseName=TestDB;domain=SQLSERVER;user=jsmith;password=qw3rty;instance=InstanceName NOTE : When connecting to a SQL Server using Windows Authentication, a common error message indicates that \u201cthe user is attempting to log in from an untrusted domain\u201d (or similar message). In order to resolve this issue, add the useNTLMv2=true property/value: jdbc:jtds:sqlserver://CIS-SERVER:1433;DatabaseName=TestDB;domain=SQLSERVER;user=jsmith;password=qw3rty;instance=InstanceName;useNTLMv2=true SQL Server Authentication SQL Server Authentication provides the ability for connections to a database instance to be made using trusted username and password information, allowing SQL Server to perform the authentication itself by checking to see if a SQL Server login account has been setup and if the password matches one previously recorded for that user. The following JDBC URLs would be valid for establishing a connection using the above example information: jdbc:jtds:sqlserver://CIS-SERVER:1433/TestDB;user=db_user;password=db_pass;instance=InstanceName or jdbc:jtds:sqlserver://CIS-SERVER:1433;DatabaseName=TestDB;user=jsmith;password=qw3rty;instance=InstanceName NOTES : The default port number for MS SQL Server databases is 1433 . The full set of connection properties supported by jTDS can be found at http://jtds.sourceforge.net/faq.html#urlFormat . VMware ESXi Endpoint Configuration Currently in development for support in CIS-CAT Pro Assessor v4. Extra configuration Options -sessions, --sessions SESSIONS.PROPERTIES The -sessions option allows users to configure multiple endpoints for assessment of a benchmark. The sessions.properties file configures CIS-CAT Pro Assessor for the assessment of remote endpoints by specifying remote hosts, ports, and credentials which the application will use for connection, collection and evaluation of benchmark recommendations and/or vulnerabilities. See \"Remote Assessment Capability\" below for more information. If no sessions.properties file exists or no connections are configured in the file, CIS-CAT Pro Assessor CLI will assess the local machine.","title":"Configuration Guide"},{"location":"ConfigurationGuide/#cis-cat-pro-assessor-configuration-guide","text":"NOTE: CIS-CAT Pro Assessor v4 is currently in BETA and this documentation will change as a result of ongoing testing and feedback. Until the official release of CIS-CAT Pro Assessor v4, please consider this document fluid.","title":"CIS-CAT Pro Assessor Configuration Guide"},{"location":"ConfigurationGuide/#introduction","text":"Utilizing the CIS-CAT Pro Assessor CLI, users are capable of performing both host-based (local) assessments, as well as remote-based assessments. In order to perform assessments of remote endpoints, certain configurations must be made. The intent of this document is to serve as a guide for enabling systems for remote-based assessments using CIS-CAT Pro Assessor.","title":"Introduction"},{"location":"ConfigurationGuide/#sessions","text":"CIS-CAT Pro Assessor v4's remote assessment capability depends on the configuration of \"sessions\"; connection parameters used to create a secure connection to the remote endpoint. A session configuration requires a number of entries, which will vary depending on the connection type.","title":"Sessions"},{"location":"ConfigurationGuide/#connection-types","text":"A number of different connection types exist to allow for maximum flexibility and coverage for the assessment of various endpoints, ranging from the local host to remote Windows, Unix, Linux, and Apple OSX endpoints, as well as Cisco network devices. Type Value Description Local local Usage of a \"local\" session is for a host-based assessment, mimicing the functionality of CIS-CAT Pro v3. Standalone or command-line applications (such as CIS-CAT Pro Assessor CLI) may use the local session to continue host-based assessments of benchmarks and/or OVAL definitions. SSH (Unix, Linux, Apple OSX) ssh The \"ssh\" session type represents a connection to a remote Unix, Linux, or Apple OSX endpoint, via SSH (obviously). SSH connections can be established a number of different ways, including username/password , username/path to a private key file , username/private key file protected with a passphrase , username/private key file + credentials to use for sudo . Windows windows The \"windows\" session type represents a WinRM connection to a remote Microsoft Windows environment. Both workstations and servers are supported with this connection type and can currently be established using username/password authentication. Cisco IOS ios The \"ios\" session type handles the specific case for the assessment of Cisco IOS network devices. Depending on the specific configuration when the \"ios\" session type is used, CIS-CAT Pro Assessor will either establish a SSH connection using username/password or username/path to a private key authentication, or will create a modified local session, collecting information from an exported configuration file. Cisco ASA asa The \"asa\" session type handles the specific case for the assessment of Cisco ASA devices. Depending on the specific configuration when the \"asa\" session type is used, CIS-CAT Pro Assessor will either establish a SSH connection using username/password or username/path to a private key authentication, or will create a modified local session, collecting information from an exported configuration file.","title":"Connection Types"},{"location":"ConfigurationGuide/#configuration-properties","text":"A number of configuration properties exist, and will vary based on the session type. Property Description type The type property MUST be configured to one of the connection types specified above ( local , ssh , windows , ios , or asa ). host The host property is required for any remote connection, and can be either the hostname or IP address (v4 or v6) of the endpoint to be assessed. Examples include 1.2.3.4 or CIS-CAT-TEST . The host property is not needed when assessing against exported network device configuration files. The host property is not needed when the session type is local . port The port property is required for any remote connection. When using the ssh connection type, the default value for the port property would be 22 . When using the windows connection type, the defaut WinRM ports are 5985 for HTTP and 5986 for HTTPS. The port property is not needed when assessing against exported network device configuration files. The port property is not needed when the session type is local . user The user property represents an administrator-level username, used to log on to the remote endpoint. This can be a domain user or a local administrator on the remote endpoint, or a privileged user when logging on to Cisco network devices. The user property is not needed when assessing against exported network device configuration files. The user property is not needed when the session type is local . cred The cred property represents the credentials for the user , in order to log on to the remote endpoint. Note that this is not encrypted, so users must take great care in safeguarding the sessions configuration file(s). NOTE : When executing CIS-CAT Pro Assessor CLI, if a given session's configuration specifies neither the cred nor the identity property, the user will be prompted to enter credentials manually. This will block assessment against other configured sessions until credentials are entered. The cred property is not needed when assessing against exported network device configuration files. The cred property is not needed when the session type is local . identity The identity property represents the full path to a private key file used for authentication to a remote endpoint. NOTE : When executing CIS-CAT Pro Assessor CLI, if a given session's configuration specifies neither the cred nor the identity property, the user will be prompted to enter credentials manually. This will block assessment against other configured sessions until credentials are entered. The identity property is not needed when assessing against exported network device configuration files. The identity property is not needed when the session type is local . identityPassphrase The identityPassphrase property is optional and should be used in conjunction with the identity property, when that key is protected with a passphrase. enable The enable property is used only in network device sessions ( ios or asa ) and represents the credentials needed to enter \"privileged EXEC\" mode; required for obtaining the full output of the show tech-support command. The enable property is not needed when assessing against exported network device configuration files. The enable property is not needed when the session type is local . tech The tech property is REQUIRED when assessing the exported configuration of a network device. This property specifies the full path to the exported configuration file. When assessing non-network device endpoints, or assessing a network devices' current running configuration via SSH, the tech property is unnecessary. The tech property is not needed when the session type is local . tmp The tmp property allows users to configure the location of the temporary \"ephemeral\" directory on the target host. This \"ephemeral\" directory is created upon connection to the target endpoint, hosts any scripts which may require executing during system characteristics collection, and is deleted upon the Assessor's completion and session disconnect. If this property is left blank or not included, the Assessor will use the default \"temp\" folder as defined for the operating system, such as /tmp or C:\\Windows\\Temp .","title":"Configuration Properties"},{"location":"ConfigurationGuide/#examples","text":"The examples below provide insight into the creation of a sessions.properties file, which can then be consumed by CIS-CAT Pro Assessor CLI to provide connection configurations when assessing a particular benchmark. By default, CIS-CAT Pro Assessor CLI will ALWAYS attempt to load a default configuration file located in the application's config folder, named sessions.properties . For example, if CCPA is installed at C:\\CIS\\Assessor-CLI , a file named C:\\CIS\\Assessor-CLI\\config\\sessions.properties will be searched for and loaded (if found). If no sessions.properties files are found or specified, a default local session will be used. Configure a session for the local host, defining a custom \"temp\" folder: session.1.type=local # Note that specifying Windows directory paths require a double-backslash \"\\\\\" as the path separator session.1.tmp=C:\\\\Temp Configure a remote Windows session using a username/password: session.2.type=windows session.2.host=123.255.198.9 session.2.port=5986 session.2.user=Administrator1 session.2.cred=s3cr3t3r! Configure a remote Windows session using a username, but requiring manual password entry: session.3.type=windows session.3.host=100.50.25.75 session.3.port=5986 session.3.user=Administrator1 Configure a remote Linux session using a username/password, defining a custom \"temp\" folder: session.4.type=ssh session.4.host=ubuntu-test.example.org session.4.port=22 session.4.user=ubuntu session.4.cred=s3cr3t3r! session.4.tmp=/home/ubuntu Configure a remote Linux session using a username/private key: session.5.type=ssh session.5.host=ubuntu-test.example.org session.5.port=22 session.5.user=ubuntu session.5.identity=/home/ubuntu/cis/ubuntu-test.ppk Configure a remote Linux session using a username/private key, with the private key being secured with a passphrase: session.6.type=ssh session.6.host=ubuntu-test.example.org session.6.port=22 session.6.user=ubuntu session.6.identity=/home/ubuntu/cis/ubuntu-test.ppk session.6.identityPassphrase=P@55phr@s3! Configure a remote Cisco IOS session using a username/password: session.7.type=ios session.7.host=9.8.7.6 session.7.port=22 session.7.user=admin session.7.cred=s3cr3t3r! session.7.enable=3nab!3d Configure a remote Cisco IOS session using a username/private key: session.8.type=ios session.8.host=9.8.7.6 session.8.port=22 session.8.user=admin # Note that specifying Windows directory paths require a double-backslash \"\\\\\" as the path separator session.8.identity=C:\\\\CIS\\\\cisco-ios.ppk session.8.enable=3nab!3d Configure a Cisco IOS session pointing to an exported configuration file: session.9.type=ios # Note that specifying Windows directory paths require a double-backslash \"\\\\\" as the path separator session.9.tech=C:\\\\CIS\\\\TS\\\\tech-support-export.txt","title":"Examples"},{"location":"ConfigurationGuide/#microsoft-windows-endpoint-configuration","text":"CIS-CAT Pro Assessor v4 utilizes the prevalent SMB protocol for file manipulation and uses WinRM for process execution. Once connected to a remote Windows endpoint, CIS-CAT Pro Assessor establishes an \"ephemeral\" directory to host script required for the collection of system characteristics from the endpoint. Once the collection/assessment has completed and the session disconnected, the \"ephemeral\" directory is removed from the endpoint. CIS-CAT Pro Assessor v4 supports both basic authentication for local accounts and Kerberos authentication for domain accounts. When authenticating with domain accounts, the new-style domain syntax, e.g. ciscatuser@example.org must be used, and NOT the old-style domain syntax, such as DOMAIN\\User . The Assessor will access the administrative shares on the remote host, which are only accessible for users that are part of the Administrators on the remote host.","title":"Microsoft Windows Endpoint Configuration"},{"location":"ConfigurationGuide/#security-considerations","text":"The majority of CIS benchmarks for Microsoft Windows operating systems contain recommendations restricting WinRM usage. The following table indicates those restrictions which will need to be relaxed in order to enable remote assessment in CIS-CAT Pro Assessor. Recommendation CIS Benchmark Value Relaxed Value 18.6.1: Ensure 'Apply UAC restrictions to local accounts on network logons' is set to 'Enabled' Enabled Disabled","title":"Security Considerations"},{"location":"ConfigurationGuide/#winrm-configuration","text":"In order for CIS-CAT Pro Assessor to connect to a remote Windows host, a number of configuration steps on those hosts must happen. The following sections will describe the configurations.","title":"WinRM Configuration"},{"location":"ConfigurationGuide/#windows-firewall-configuration","text":"CIS-CAT Pro Assessor v4 uses both the SMB and WinRM protocols in order to enable file manipulation and process execution, respectively. As such, to connect to the remote host using SMB, ensure the host is reachable on port 445 . To enable connection to the remote host using WinRM over HTTPS, ensure the host is reachable on port 5986 . Users can enable these firewall rules simply using PowerShell and the script provided with the CIS-CAT Pro Assessor v4 application bundle. The bundle will contain a setup folder, in which will be locate the CISCAT_Pro_Assessor_v4_Firewall_SMB_WinRM.ps1 script. Execute this script in PowerShell to configure the Windows Firewall.","title":"Windows Firewall Configuration"},{"location":"ConfigurationGuide/#enable-winrm","text":"On the remote Windows host, open a Command Prompt using the \"Run as Administrator\" option. Enter the following command to enable the default configuration for WinRM: winrm quickconfig A confirmation prompt may be presented to the user. If so, type Y and hit Enter . Performing the quickconfig will start the Windows Remote Management service, configure an HTTP listener and create exceptions in the Windows Firewall for the WinRM service. If users intend to connect to remote endpoints using WinRM over HTTP (and not HTTPS), then WinRM must be configured to \"Allow unencrypted traffic\": winrm set winrm/config/service @{AllowUnencrypted=\"true\"} By default, Kerberos authentication is enabled in WinRM. Disable it if CIS-CAT Pro Assessor will NOT be authenticating using domain accounts: winrm set winrm/config/service/Auth @{Kerberos=\"false\"} NOTE : Do not disable \"Negotiate\" authentication as the winrm command itself uses that to configure the WinRM subsystem. Finally, configure WinRM to provide enough memory to the commands that are going to be executed, e.g. 1024 MB: winrm set winrm/config/winrs @{MaxMemoryPerShellMB=\"1024\"}","title":"Enable WinRM"},{"location":"ConfigurationGuide/#configure-winrm-over-https","text":"In order for CIS-CAT Pro Assessor to access the remote Windows host using WinRM over HTTPS, an HTTPS WinRM Listener must be configured using the thumbprint of a certificate for that host. Users can attempt to find an existing certificate thumbprint for the remote host using PowerShell. In the following commands, assume HOSTNAME is the DNS name of the remote Windows host: PS C:\\Windows\\system32 Get-childItem cert:\\LocalMachine\\Root\\ | Select-String -pattern HOSTNAME If a certificate exists on the system, the PowerShell command will yield results similar to the following: [Subject] CN=HOSTNAME [Issuer] CN=HOSTNAME [Serial Number] 527E7AF9142D96AD49A10469A264E766 [Not Before] 5/23/2011 10:23:33 AM [Not After] 5/20/2021 10:23:33 AM [Thumbprint] 5C36B638BC31F505EF7F693D9A60C01551DD486F Once the certificate thumbprint is found, create the HTTPS WinRM listener for the remote host: winrm create winrm/config/Listener?Address=*+Transport=HTTPS @{Hostname=\"HOSTNAME\"; CertificateThumbprint=\"THUMBPRINT\"} Where HOSTNAME is the DNS name of the remote host, such as WINSERVER1 , and THUMBPRINT is the certificate thumbprint found in PowerShell, for example 5C36B638BC31F505EF7F693D9A60C01551DD486F If no results are returned, the user may create a self-signed certificate using PowerShell and a script provided with the CIS-CAT Pro Assessor v4 application bundle. The bundle will contain a setup folder, in which will be located the CISCAT_Pro_Assessor_v4_SelfSignedCertificate.ps1 script. Execute this script in PowerShell to configure the self-signed certificate and create the WinRM HTTPS listener.","title":"Configure WinRM over HTTPS"},{"location":"ConfigurationGuide/#disable-uac-remote-restrictions","text":"To better protect those users who are members of the local Administrators group, Microsoft implemented UAC restrictions on the network. This mechanism helps prevent against \"loopback\" attacks. This mechanism also helps prevent local malicious software from running remotely with administrative rights. When a user who is a member of the local administrators group on the target remote computer establishes a remote administrative connection by using the net use * \\\\remotecomputer\\Share$ command, for example, they will not connect as a full administrator. The user has no elevation potential on the remote computer, and the user cannot perform administrative tasks. If the user wants to administer the workstation with a Security Account Manager (SAM) account, the user must interactively log on to the computer that is to be administered with Remote Assistance or Remote Desktop, if these services are available. To disable UAC remote restrictions, follow these steps: Click Start, click Run, type regedit , and then press ENTER . Locate and then click the following registry subkey: HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Policies\\System If the LocalAccountTokenFilterPolicy registry entry does not exist, follow these steps: On the Edit menu, point to New , and then click DWORD Value . Type LocalAccountTokenFilterPolicy , and then press ENTER . Right-click LocalAccountTokenFilterPolicy , and then click Modify . In the Value data box, type 1 , and then click OK . Exit Registry Editor. In Windows domain environments, this setting can be configured through Group Policy, however, the Group Policy Object is not a standard policy and must be downloaded and installed separately. Generally, if an environment has installed the Microsoft Security Compliance Manager (SCM), the GPO is included there and can be exported. Otherwise, the Group Policy Objects can be found either here or here .","title":"Disable UAC remote restrictions"},{"location":"ConfigurationGuide/#domain-considerations","text":"If users are planning on authenticating to remote Windows hosts using domain accounts, configuration is necessary both on the remote host, and on the \"source\" host (the machine hosting CIS-CAT Pro Assessor v4). Kerberos - Source Host Depending on the operating system of the source hose, create a file called krb5.conf (Unix) or krb5.ini (Windows) with at least the following content: [realms] EXAMPLE.ORG = { kdc = KDC.EXAMPLE.ORG } Replace the values with the name of your domain/realm and the hostname of your domain controller (multiple entries can be added to allow the source host to connect to multiple domains) and place the file in the default location for your operating system: Linux: /etc/krb5.conf Solaris: /etc/krb5/krb5.conf Windows: C:\\Windows\\krb5.ini Kerberos - Remote Host By default, the CIS-CAT Pro Assessor's connection to a remote Windows host will request access to a Kerberos service principal name of the form WSMAN/HOST . This SPN should be configured automatically when configuring WinRM for the remote host (the \"Enable WinRM\" section above). To verify the SPN has been created, list all the SPNs configured on the remote host: setspn -L HOSTNAME If the WSMAN/HOSTNAME SPN is not listed, it must be configured. From any host in the domain, invoke the setspn command: setspn -A WSMAN/ADDRESS HOSTNAME Where ADDRESS is the address (DNS Name or IP Address) used to connect to the remote host, and HOSTNAME is the short Windows hostname of the remote host.","title":"Domain Considerations"},{"location":"ConfigurationGuide/#unixlinuxosx-endpoint-configuration","text":"CIS-CAT Pro Assessor assesses remote Unix/Linux/OSX targets via SSH connections. Ensure the target system can be accessed via SSH and that the user connecting to the remote target is either the root user or a user granted privileges to execute commands using sudo .","title":"Unix/Linux/OSX Endpoint Configuration"},{"location":"ConfigurationGuide/#cisco-network-device-endpoint-configuration","text":"CIS-CAT Pro Assessor v4 can assess either the current running configuration of a Cisco network device, or an exported configuration file.","title":"Cisco Network Device Endpoint Configuration"},{"location":"ConfigurationGuide/#connecting-to-a-device","text":"CIS-CAT Pro Assessor assesses Cisco network device targets via SSH connections. Ensure the target system can be accessed via SSH and that the user connecting to the remote target is a privileged user. When connecting to Cisco devices, CIS-CAT Pro Assessor will be configured to enter \"privileged EXEC\" mode, so any user connecting to the Cisco device via SSH must be granted appropriate permission to do so.","title":"Connecting to a Device"},{"location":"ConfigurationGuide/#exported-configuration-file","text":"CIS-CAT Pro Assessor can also assess an exported configuration file; the output of the show tech-support command. The output from the show tech-support command is very long. To better manage this output, you can redirect the output to a file (for example, show tech-support *filename* ) in the local writable storage file system or the remote file system. You can use one of the following redirection methods: filename \u2014Redirects the output to a file. filename \u2014Redirects the output to a file in append mode. This example shows how to redirect the technical support information to a file: switch# show tech-support bootflash:TechSupport.txt Once the exported configuration file is available to CIS-CAT Pro Assessor, the assessment can be performed against it. See the example above entitled \"Configure a Cisco IOS session pointing to an exported configuration file\" to configure the appropriate Assessor \"session\".","title":"Exported Configuration File"},{"location":"ConfigurationGuide/#database-endpoint-configuration","text":"Assessing database benchmarks in CIS-CAT Pro Assessor v4 uses the same JDBC connection mechanism as previous versions. Database benchmarks will require a user to enter the JDBC connection string, or utilize the ciscat.properties file to set the appropriate value for assessment.","title":"Database Endpoint Configuration"},{"location":"ConfigurationGuide/#oracle-database","text":"The JDBC string parameter is the connection string used to connect to and authenticate to the Oracle Database service and instance that CIS-CAT will assess. The Oracle JDBC driver has the ability to connect to Oracle database instances using either the SID or Service Name. When connecting to an Oracle database using the SID, the format of the JDBC connection string is: jdbc:oracle:thin:[username]/[password]@[hostname]:[port]:[SID] For example: jdbc:oracle:thin:sys as sysdba/pa55w0rd!@servername:1521:ORCL When connecting to an Oracle database using the Service Name, the format of the JDBC connection string is: jdbc:oracle:thin:[username]/[password]@//[hostname]:[port]/[service_name] For example: jdbc:oracle:thin:sys as sysdba/pa55w0rd!@//servername:1521/SERVICE_NAME The following table describes the components of the Oracle JDBC connection string. Property Name Property Description username A valid username who can connect to the database instance. This user should have sufficient privileges to SELECT from the various tables and views indicated in the specific Oracle benchmark, or be granted SYSDBA privileges. password The credentials for the specified username to connect to the database instance. hostname The name of the server (or it's IP address) hosting the database. port The port number on which the database is listening. By default, Oracle databases are configured to listen on port 1521. SID The database SID. Service Name The database Service Name.","title":"Oracle Database"},{"location":"ConfigurationGuide/#oracle-mysql-database","text":"Oracle MySQL database support is implemented using the MariaDB JDBC driver. The format for the MariaDB JDBC connection string for MySQL is: jdbc:mysql:// host : port / database ? key1 = value1 key2 = value2 ... Consider a MySQL database instance with the following information: Property Name Property Value Server Name CIS-SERVER Database Name TestDB Database Port 3306 Username db_user Credentials db_pass When configuring the JDBC connection string in CIS-CAT Pro Assessor, the above information would yield: jdbc:mysql://CIS-SERVER:3306/TestDB?user=db_user password=db_pass Notable optional parameters involve ensuring JDBC connections are made via SSL: Property Name Property Description user The database username. password The credentials for the specified user to connect to the database instance. useSSL Force the usage of SSL on the connection. trustServerCertificate When using SSL, do not verify the server's certificate. serverSslCert Server's certificate in DER form, or server's CA certificate. Can be used in one of 3 forms: serverSslCert=/path/to/cert.pem : full path to certificate serverSslCert =classpath:relative/cert.pem : relative to current classpath or as verbatim DER-encoded certificate string, starting with ------BEGIN CERTIFICATE----- NOTES The default port number for MySQL is 3306 The full set of connection properties/optional URL parameters supported by MariaDB can be found at https://mariadb.com/kb/en/mariadb/about-the-mariadb-java-client/","title":"Oracle MySQL Database"},{"location":"ConfigurationGuide/#postgresql-database","text":"CIS-CAT Pro Assessor has implemented support for assessments against PostgreSQL database instances using the PostgreSQL JDBC driver. The format for the PostgreSQL JDBC connection string is: jdbc:postgresql:// host : port / database ? key1 = value1 key2 = value2 ... Consider a PostgreSQL database instance with the following information: Property Name Property Value Server Name CIS-POSTGRESQL Database Name PostgreSQL-DB Database Port 5432 (the default) Username db_user Credentials db_pass When configuring the JDBC connection string in CIS-CAT Pro Assessor, the above information would yield: jdbc:postgresql://CIS-POSTGRESQL:5432/PostgreSQL-DB?user=db_user password=db_pass If CIS-CAT Pro Assessor is connecting to PostgreSQL on the default port (5432), it can be omitted from the connection string: jdbc:postgresql://CIS-POSTGRESQL/PostgreSQL-DB?user=db_user password=db_pass Notable optional parameters involve ensuring JDBC connections are made via SSL: Property Name Property Description user The database username. password The credentials for the specified user to connect to the database instance. ssl A boolean value ( true or false ), to force the usage of SSL on the connection. For example, in order to force the database connection to require SSL, the connection string would look like: jdbc:postgresql://CIS-POSTGRESQL/PostgreSQL-DB?user=db_user password=db_pass ssl=true NOTES The default port number for PostgreSQL is 5432 The full set of connection properties/optional URL parameters supported by PostgreSQL can be found at https://jdbc.postgresql.org/documentation/head/connect.html","title":"PostgreSQL Database"},{"location":"ConfigurationGuide/#microsoft-sql-server","text":"Microsoft SQL Server database support is implemented using the jTDS open source JDBC driver. The jTDS driver provides support for SQL Server 6.5, 7, 2000, 2005, 2008, and 2012. The format of the jTDS JDBC URL for MS SQL Server is: jdbc:jtds:sqlserver:// server [: port ][/ database ][; property = value ] Properties required for the database connection can be provided as property = value pairs, separated by a semi-colon ; Consider a Microsoft SQL Server database instance with the following information: Property Name Property Value Server Name CIS-SERVER Database Name TestDB Database Port 1433 Windows Domain WIN-DOMAIN Windows Domain User/Password jsmith/qw3rty SQL Server Database User/Password db_user/db_pass Instance Name InstanceName","title":"Microsoft SQL Server"},{"location":"ConfigurationGuide/#windows-authentication","text":"Windows Authentication Mode allows a user to connect to a SQL Server instance through a Microsoft Windows user account. This mode allows domain user account information to be supplied in order to establish a connection. The following JDBC connection string would be valid for establishing a connection using the above example information: jdbc:jtds:sqlserver://CIS-SERVER:1433/TestDB;domain=WIN-DOMAIN;user=jsmith;password=qw3rty;instance=InstanceName Windows Authentication Mode may also be used against databases running on machines not joined to a domain (standalone servers). When authenticating with Microsoft Windows user accounts to non-domain joined servers, substitute in the computer name for the domain. For example, if the name of the standalone server is SQLSERVER , the JDBC connection string would look as such: jdbc:jtds:sqlserver://CIS-SERVER:1433;DatabaseName=TestDB;domain=SQLSERVER;user=jsmith;password=qw3rty;instance=InstanceName NOTE : When connecting to a SQL Server using Windows Authentication, a common error message indicates that \u201cthe user is attempting to log in from an untrusted domain\u201d (or similar message). In order to resolve this issue, add the useNTLMv2=true property/value: jdbc:jtds:sqlserver://CIS-SERVER:1433;DatabaseName=TestDB;domain=SQLSERVER;user=jsmith;password=qw3rty;instance=InstanceName;useNTLMv2=true","title":"Windows Authentication"},{"location":"ConfigurationGuide/#sql-server-authentication","text":"SQL Server Authentication provides the ability for connections to a database instance to be made using trusted username and password information, allowing SQL Server to perform the authentication itself by checking to see if a SQL Server login account has been setup and if the password matches one previously recorded for that user. The following JDBC URLs would be valid for establishing a connection using the above example information: jdbc:jtds:sqlserver://CIS-SERVER:1433/TestDB;user=db_user;password=db_pass;instance=InstanceName or jdbc:jtds:sqlserver://CIS-SERVER:1433;DatabaseName=TestDB;user=jsmith;password=qw3rty;instance=InstanceName NOTES : The default port number for MS SQL Server databases is 1433 . The full set of connection properties supported by jTDS can be found at http://jtds.sourceforge.net/faq.html#urlFormat .","title":"SQL Server Authentication"},{"location":"ConfigurationGuide/#vmware-esxi-endpoint-configuration","text":"Currently in development for support in CIS-CAT Pro Assessor v4.","title":"VMware ESXi Endpoint Configuration"},{"location":"ConfigurationGuide/#extra-configuration-options","text":"-sessions, --sessions SESSIONS.PROPERTIES The -sessions option allows users to configure multiple endpoints for assessment of a benchmark. The sessions.properties file configures CIS-CAT Pro Assessor for the assessment of remote endpoints by specifying remote hosts, ports, and credentials which the application will use for connection, collection and evaluation of benchmark recommendations and/or vulnerabilities. See \"Remote Assessment Capability\" below for more information. If no sessions.properties file exists or no connections are configured in the file, CIS-CAT Pro Assessor CLI will assess the local machine.","title":"Extra configuration Options"},{"location":"CoverageGuide/","text":"CIS-CAT Pro Assessor Coverage Guide NOTE: CIS-CAT Pro Assessor v4 is currently in BETA and this documentation will change as a result of ongoing testing and feedback. Until the official release of CIS-CAT Pro Assessor v4, please consider this document fluid. Introduction This document provides information about the assessment capabilities of CIS-CAT Pro Assessor v4, such as included benchmarks, OVAL test types, scripting capabilities, etc. CIS Benchmark Coverage CIS currently distributes CIS-CAT with production support for the following benchmarks. The benchmarks utilize standards included in the Security Content Automation Protocol, such as the eXtensible Configuration Checklist Description Format (XCCDF) and the Open Vulnerability and Assessment Language (OVAL). Note that any benchmark listed below which displays a bulleted list of \" id :description\" information are those benchmarks which contain \"interactive values\". Please see the CIS-CAT Pro Assessor CLI User's Guide for more information regarding configuration of these values. CIS Amazon Linux Benchmark, v2.0.0 CIS Apple OSX 10.10 Benchmark, v1.2.0 CIS Apple OSX 10.11 Benchmark, v1.1.0 CIS Apple OSX 10.12 Benchmark, v1.0.0 CIS CentOS Linux 6 Benchmark, v2.0.2 CIS CentOS Linux 7 Benchmark, v2.2.0 CIS Cisco IOS 12 Benchmark, v4.0.0 CIS Cisco IOS 15 Benchmark, v4.0.0 CIS Debian Linux 7 Benchmark, v1.0.0 CIS Debian Linux 8 Benchmark, v1.0.0 CIS Google Chrome Benchmark, v1.3.0 CIS MIT Kerberos 1.10 Benchmark, v1.0.0 CIS Microsoft IIS 7 Benchmark, v1.8.0 CIS Microsoft IIS 8 Benchmark, v1.5.0 CIS Microsoft Internet Explorer 10 Benchmark, v1.1.0 CIS Microsoft Internet Explorer 11 Benchmark, v1.0.0 CIS Microsoft Office Access 2013 Benchmark, v1.0.1 CIS Microsoft Office Access 2016 Benchmark, v1.0.1 CIS Microsoft Office Excel 2013 Benchmark, v1.0.1 CIS Microsoft Office Excel 2016 Benchmark, v1.0.1 CIS Microsoft Office Outlook 2013 Benchmark, v1.1.0 CIS Microsoft Office Outlook 2016 Benchmark, v1.1.0 CIS Microsoft Office PowerPoint 2013 Benchmark, v1.0.1 CIS Microsoft Office PowerPoint 2016 Benchmark, v1.0.1 CIS Microsoft Office Word 2013 Benchmark, v1.1.0 CIS Microsoft Office Word 2016 Benchmark, v1.1.0 CIS Microsoft Office 2013 Benchmark, v1.1.0 CIS Microsoft Office 2016 Benchmark, v1.1.0 CIS Microsoft SQL Server 2008 R2 Benchmark, v1.5.0 xccdf_org.cisecurity_value_jdbc.url : SQL Server connection string. CIS Microsoft SQL Server 2012 Benchmark, v1.4.0 xccdf_org.cisecurity_value_jdbc.url : SQL Server connection string. CIS Microsoft SQL Server 2014 Benchmark, v1.3.0 xccdf_org.cisecurity_value_jdbc.url : SQL Server connection string. CIS Microsoft SQL Server 2016 Benchmark, v1.0.0 xccdf_org.cisecurity_value_jdbc.url : SQL Server connection string. CIS Microsoft Windows 10 Enterprise Release 1607 Benchmark, v1.2.0 CIS Microsoft Windows 10 Enterprise Release 1703 Benchmark, v1.3.0 CIS Microsoft Windows 10 Enterprise Release 1709 Benchmark, v1.4.0 CIS Microsoft Windows Server 2003 Benchmark, v3.1.0 CIS Microsoft Windows Server 2008 (non-R2) Benchmark, v3.1.0 CIS Microsoft Windows Server 2008 R2 Benchmark, v3.1.0 CIS Microsoft Windows Server 2012 (non-R2) Benchmark, v2.1.0 CIS Microsoft Windows Server 2012 R2 Benchmark, v2.3.0 CIS Microsoft Windows Server 2016 RTM (Release 1607) Benchmark, v1.0.0 CIS Microsoft Windows 7 Workstation Benchmark, v3.1.0 CIS Microsoft Windows 8 Benchmark, v1.0.0 CIS Microsoft Windows 8.1 Workstation Benchmark, v2.3.0 CIS Microsoft Windows XP Benchmark, v3.1.0 CIS Mozilla Firefox 24 ESR Benchmark, v1.0.0 CIS Mozilla Firefox 38 ESR Benchmark, v1.0.0 CIS Oracle MySQL Community Server 5.6 Benchmark, v1.0.0 xccdf_org.cisecurity_value_jdbc.url : MySQL Server connection string. xccdf_org.cisecurity_value_repl.user : MySQL replication user name. CIS Oracle MySQL Enterprise Edition 5.6 Benchmark, v1.0.0 xccdf_org.cisecurity_value_jdbc.url : MySQL Server connection string. xccdf_org.cisecurity_value_repl.user : MySQL replication user name. CIS Oracle MySQL Community Server 5.7 Benchmark, v1.0.0 xccdf_org.cisecurity_value_jdbc.url : MySQL Server connection string. xccdf_org.cisecurity_value_repl.user : MySQL replication user name. CIS Oracle MySQL Enterprise Edition 5.7 Benchmark, v1.0.0 xccdf_org.cisecurity_value_jdbc.url : MySQL Server connection string. xccdf_org.cisecurity_value_repl.user : MySQL replication user name. CIS Oracle Database 11g R2 Benchmark, v2.2.0 xccdf_org.cisecurity_value_jdbc.url : Oracle 11g R2 Server connection string. xccdf_org.cisecurity_value_listener.ora : Path to the listener.ora file CIS Oracle Database 12c Benchmark, v2.0.0 xccdf_org.cisecurity_value_jdbc.url : Oracle Database connection string. xccdf_org.cisecurity_value_listener.ora : Path to the listener.ora file CIS Oracle Linux 6 Benchmark, v1.0.0 CIS Oracle Linux 7 Benchmark, v2.0.0 CIS PostgreSQL 9.5 Benchmark, v1.0.0 xccdf_org.cisecurity_value_jdbc.url : PostgreSQL Database connection string. CIS Red Hat Enterprise Linux 5 Benchmark, v2.2.0 CIS Red Hat Enterprise Linux 6 Benchmark, v2.0.2 CIS Red Hat Enterprise Linux 7 Benchmark, v2.1.1 CIS SUSE Linux Enterprise 11 Benchmark, v2.0.0 CIS SUSE Linux Enterprise 12 Benchmark, v2.0.0 CIS Ubuntu Linux 14.04 LTS Benchmark, v2.0.0 CIS Ubuntu Linux 16.04 LTS Benchmark, v1.0.0 CIS Ubuntu Linux 18.04 LTS Benchmark, v1.0.0 NOTE : Any benchmarks which utilized CIS' proprietary Embedded Check Language (ECL) are not yet supported in CIS-CAT Pro Assessor v4. Further development will either implement these benchmarks using currently available scripting capabilities, or will be migrated to OVAL when platform coverage is expanded. Platform Coverage for Vulnerability Assessments Using the -vdd command-line option, CIS-CAT Pro Assessor v4 is able to download the latest vulnerability definitions from various repositories. A number of different platforms are officially supported by CIS-CAT Pro Assessor v4, including: Platform Downloaded From Microsoft Windows XP https://oval.cisecurity.org/repository/download/5.10/vulnerability Microsoft Windows 7 https://oval.cisecurity.org/repository/download/5.10/vulnerability Microsoft Windows 8 https://oval.cisecurity.org/repository/download/5.10/vulnerability Microsoft Windows 8.1 https://oval.cisecurity.org/repository/download/5.10/vulnerability Microsoft Windows 10 https://oval.cisecurity.org/repository/download/5.10/vulnerability Microsoft Windows Server 2003 https://oval.cisecurity.org/repository/download/5.10/vulnerability Microsoft Windows Server 2008 https://oval.cisecurity.org/repository/download/5.10/vulnerability Microsoft Windows Server 2008 R2 https://oval.cisecurity.org/repository/download/5.10/vulnerability Microsoft Windows Server 2012 https://oval.cisecurity.org/repository/download/5.10/vulnerability Microsoft Windows Server 2012 R2 https://oval.cisecurity.org/repository/download/5.10/vulnerability Microsoft Windows Server 2016 https://oval.cisecurity.org/repository/download/5.10/vulnerability Red Hat Enterprise Linux https://www.redhat.com/security/data/oval SuSE Linux Enterprise Server 9 https://support.novell.com/security/oval SuSE Linux Enterprise Server 10 https://support.novell.com/security/oval SuSE Linux Enterprise Server 11 https://support.novell.com/security/oval SuSE Linux Enterprise Server 12 https://support.novell.com/security/oval Ubuntu Linux 12.04 https://people.canonical.com/~ubuntu-security/oval Ubuntu Linux 14.04 https://people.canonical.com/~ubuntu-security/oval Ubuntu Linux 16.04 https://people.canonical.com/~ubuntu-security/oval Ubuntu Linux 18.04 https://people.canonical.com/~ubuntu-security/oval OVAL Capabilities International in scope and free for public use, OVAL is an information security community effort to standardize how to assess and report upon the machine state of computer systems. OVAL includes a language to encode system details, and an assortment of content repositories held throughout the community. Tools and services that use OVAL for the three steps of system assessment \u2014 representing system information, expressing specific machine states, and reporting the results of an assessment \u2014 provide enterprises with accurate, consistent, and actionable information so they may improve their security. Use of OVAL also provides for reliable and reproducible information assurance metrics and enables interoperability and automation among security tools and services. Platform Independent Test Name Implemented? Notes Environment Variable ( 5.8) Y Environment Variable (5.8+) N In development Family Y File Hash ( 5.8) Y File Hash (5.8+) Y LDAP ( 5.7) Y LDAP (5.7+) N Deprecated SQL ( 5.7+) N Deprecated SQL (5.7+) Y Text File Content ( 5.4) Y Text File Content (5.4+) Y Unknown Y Variable Y XML File Content Y Microsoft Windows Test Name Implemented? Notes Access Token Y Active Directory ( 5.7) N On roadmap Active Directory (5.7+) N In Development Audit Event Policy Y Audit Event Policy Subcategories Y Cmdlet Y DNSCache N On roadmap File Y File Audited Permissions ( 5.3) Y File Audited Permissions (5.3+) Y File Effective Rights ( 5.3) Y File Effective Rights (5.3+) Y Group Y Group SID Y Interface Y Junction Y License Y Lockout Policy Y Metabase N NTUser N On roadmap Password Policy Y PEHeader Y Port Y Printer Effective Rights N Process ( 5.8) Y Process (5.8+) Y Registry Y Registry Key Audited Permissions ( 5.3) Y Registry Key Audited Permissions (5.3+) Y Registry Key Effective Rights ( 5.3) Y Registry Key Effective Rights (5.3+) Y Service Y Service Effective Rights Y Shared Resource Y Shared Resource Audited Permissions Y Shared Resource Effective Rights Y SID Y SID SID Y System Metric Y UAC Y User Y User Rights Y User SID ( 5.5) Y User SID (5.5+) Y Volume Y WMI ( 5.7) Y WMI (5.7+) Y WUA Update Searcher Y Unix Test Name Implemented? Notes DNSCache N On roadmap File Y File Extended Attribute Y Gconf Y Inetd Y Interface Y Password Y Process ( 5.8) N On roadmap Process (5.8+) Y Routing Table N On roadmap Runlevel Y SCCS N On roadmap Shadow Y Symlink Y Sysctl Y Uname Y Xinetd Y Linux Test Name Implemented? Notes AppArmor Status Y DpkgInfo Y IfListeners N On roadmap Inet Listening Servers Y Partition Y RPM Info Y RPM Verify N On roadmap RPM Verify File N On roadmap RPM Verify Package N On roadmap SELinux Booleans Y SELinux Security Context N On roadmap Slackware PkgInfo N On roadmap Systemd Unit Dependency N On roadmap Systemd Unit Property Y Mac OSX Test Name Implemented? Notes Account Info Y Authorization DB Y CoreStorage N In development DiskUtil N In development Gatekeeper Y Inet Listening Servers ( 5.10) N In development Inet Listening Servers (5.10+) N In development Keychain N In development Launchd Y Nvram N In development Plist ( 5.10) Y Plist (5.10) Y Plist (5.11+) Y Pwpolicy ( 5.9) N In development Pwpolicy (5.9+) N In development Rlimit Y Software Update N In development System Profiler N In development System Setup N In development Cisco ASA Test Name Implemented? Notes ACL N In development Class Map N In development Interface N In development Line N In development Policy Map N In development Service Policy N In development SNMP Host N In development SNMP Group N In development SNMP User N In development TCP Map N In development Version N In development Cisco IOS Test Name Implemented? Notes ACL Y Partial implementation BGP Neighbor Y Global Y Interface Y Line Y Router Y Routing Protocol Auth. Intf. Y Section Y SNMP Y SNMP Community Y SNMP Group Y SNMP Host Y SNMP User Y SNMP View Y Tclsh Y Version ( 5.5) Y Version (5.5+) Y Microsoft IIS (Extension) Test Name Implemented? Notes Application Host Config Y Application Pool Y Site Bindings Y System Web Y Web Config Y VMware ESXi (Extension) Test Name Implemented? Notes VMHost Acceptance Level N In development VMHost VIB N In development VMHost Module N In development VMHost Coredump N In development VMHost Web Server SSL N In development VMHost Authentication N In development VMHost Account N In development VMHost SNMP N In development VMHost Advanced Setting N In development VMHost Service N In development VMHost NTP Server N In development VMHost Lockdown N In development VMHost Firewall Exception N In development VMHost Bus Adapter N In development VMHost iSCSI Host Bus Adapter N In development VMHost vSwitch Policy N In development VM Advanced Setting N In development VM Device N In development VM Hard Disk Device N In development VM Resource Config N In development Virtual Port Group N In development Other Test Name Implemented? Notes Shell Command Y Extension, Platform Independent Invalid User Home Directory Ownership Y Extension, Linux Scripting Capabilities CIS-CAT Pro Assessor implements the Script Check Engine (SCE) check system, initially introduced as part of the OpenSCAP project. Using SCE in XCCDF documents allows administrators to use already-created scripts written in Bash, Windows Batch files, PowerShell, VBScript, etc. in benchmark recommendations. CIS-CAT Pro Assessor supports using SCE usage with the following scripting languages: bash PowerShell Windows batch scripts VBScript CIS Embedded Check Language (ECL) CIS-CAT Pro Assessor contains minimal implementation of CIS' proprietary Embedded Check Language (ECL). A subset of the total available functionality has been developed, in order to support both local and remote assessment of Apple OSX benchmarks. The following ECL constructs have been implemented: File Content Shell Command Platform Note that further ECL implementation is tentative and may not be included in future releases.","title":"Coverage Guide"},{"location":"CoverageGuide/#cis-cat-pro-assessor-coverage-guide","text":"NOTE: CIS-CAT Pro Assessor v4 is currently in BETA and this documentation will change as a result of ongoing testing and feedback. Until the official release of CIS-CAT Pro Assessor v4, please consider this document fluid.","title":"CIS-CAT Pro Assessor Coverage Guide"},{"location":"CoverageGuide/#introduction","text":"This document provides information about the assessment capabilities of CIS-CAT Pro Assessor v4, such as included benchmarks, OVAL test types, scripting capabilities, etc.","title":"Introduction"},{"location":"CoverageGuide/#cis-benchmark-coverage","text":"CIS currently distributes CIS-CAT with production support for the following benchmarks. The benchmarks utilize standards included in the Security Content Automation Protocol, such as the eXtensible Configuration Checklist Description Format (XCCDF) and the Open Vulnerability and Assessment Language (OVAL). Note that any benchmark listed below which displays a bulleted list of \" id :description\" information are those benchmarks which contain \"interactive values\". Please see the CIS-CAT Pro Assessor CLI User's Guide for more information regarding configuration of these values. CIS Amazon Linux Benchmark, v2.0.0 CIS Apple OSX 10.10 Benchmark, v1.2.0 CIS Apple OSX 10.11 Benchmark, v1.1.0 CIS Apple OSX 10.12 Benchmark, v1.0.0 CIS CentOS Linux 6 Benchmark, v2.0.2 CIS CentOS Linux 7 Benchmark, v2.2.0 CIS Cisco IOS 12 Benchmark, v4.0.0 CIS Cisco IOS 15 Benchmark, v4.0.0 CIS Debian Linux 7 Benchmark, v1.0.0 CIS Debian Linux 8 Benchmark, v1.0.0 CIS Google Chrome Benchmark, v1.3.0 CIS MIT Kerberos 1.10 Benchmark, v1.0.0 CIS Microsoft IIS 7 Benchmark, v1.8.0 CIS Microsoft IIS 8 Benchmark, v1.5.0 CIS Microsoft Internet Explorer 10 Benchmark, v1.1.0 CIS Microsoft Internet Explorer 11 Benchmark, v1.0.0 CIS Microsoft Office Access 2013 Benchmark, v1.0.1 CIS Microsoft Office Access 2016 Benchmark, v1.0.1 CIS Microsoft Office Excel 2013 Benchmark, v1.0.1 CIS Microsoft Office Excel 2016 Benchmark, v1.0.1 CIS Microsoft Office Outlook 2013 Benchmark, v1.1.0 CIS Microsoft Office Outlook 2016 Benchmark, v1.1.0 CIS Microsoft Office PowerPoint 2013 Benchmark, v1.0.1 CIS Microsoft Office PowerPoint 2016 Benchmark, v1.0.1 CIS Microsoft Office Word 2013 Benchmark, v1.1.0 CIS Microsoft Office Word 2016 Benchmark, v1.1.0 CIS Microsoft Office 2013 Benchmark, v1.1.0 CIS Microsoft Office 2016 Benchmark, v1.1.0 CIS Microsoft SQL Server 2008 R2 Benchmark, v1.5.0 xccdf_org.cisecurity_value_jdbc.url : SQL Server connection string. CIS Microsoft SQL Server 2012 Benchmark, v1.4.0 xccdf_org.cisecurity_value_jdbc.url : SQL Server connection string. CIS Microsoft SQL Server 2014 Benchmark, v1.3.0 xccdf_org.cisecurity_value_jdbc.url : SQL Server connection string. CIS Microsoft SQL Server 2016 Benchmark, v1.0.0 xccdf_org.cisecurity_value_jdbc.url : SQL Server connection string. CIS Microsoft Windows 10 Enterprise Release 1607 Benchmark, v1.2.0 CIS Microsoft Windows 10 Enterprise Release 1703 Benchmark, v1.3.0 CIS Microsoft Windows 10 Enterprise Release 1709 Benchmark, v1.4.0 CIS Microsoft Windows Server 2003 Benchmark, v3.1.0 CIS Microsoft Windows Server 2008 (non-R2) Benchmark, v3.1.0 CIS Microsoft Windows Server 2008 R2 Benchmark, v3.1.0 CIS Microsoft Windows Server 2012 (non-R2) Benchmark, v2.1.0 CIS Microsoft Windows Server 2012 R2 Benchmark, v2.3.0 CIS Microsoft Windows Server 2016 RTM (Release 1607) Benchmark, v1.0.0 CIS Microsoft Windows 7 Workstation Benchmark, v3.1.0 CIS Microsoft Windows 8 Benchmark, v1.0.0 CIS Microsoft Windows 8.1 Workstation Benchmark, v2.3.0 CIS Microsoft Windows XP Benchmark, v3.1.0 CIS Mozilla Firefox 24 ESR Benchmark, v1.0.0 CIS Mozilla Firefox 38 ESR Benchmark, v1.0.0 CIS Oracle MySQL Community Server 5.6 Benchmark, v1.0.0 xccdf_org.cisecurity_value_jdbc.url : MySQL Server connection string. xccdf_org.cisecurity_value_repl.user : MySQL replication user name. CIS Oracle MySQL Enterprise Edition 5.6 Benchmark, v1.0.0 xccdf_org.cisecurity_value_jdbc.url : MySQL Server connection string. xccdf_org.cisecurity_value_repl.user : MySQL replication user name. CIS Oracle MySQL Community Server 5.7 Benchmark, v1.0.0 xccdf_org.cisecurity_value_jdbc.url : MySQL Server connection string. xccdf_org.cisecurity_value_repl.user : MySQL replication user name. CIS Oracle MySQL Enterprise Edition 5.7 Benchmark, v1.0.0 xccdf_org.cisecurity_value_jdbc.url : MySQL Server connection string. xccdf_org.cisecurity_value_repl.user : MySQL replication user name. CIS Oracle Database 11g R2 Benchmark, v2.2.0 xccdf_org.cisecurity_value_jdbc.url : Oracle 11g R2 Server connection string. xccdf_org.cisecurity_value_listener.ora : Path to the listener.ora file CIS Oracle Database 12c Benchmark, v2.0.0 xccdf_org.cisecurity_value_jdbc.url : Oracle Database connection string. xccdf_org.cisecurity_value_listener.ora : Path to the listener.ora file CIS Oracle Linux 6 Benchmark, v1.0.0 CIS Oracle Linux 7 Benchmark, v2.0.0 CIS PostgreSQL 9.5 Benchmark, v1.0.0 xccdf_org.cisecurity_value_jdbc.url : PostgreSQL Database connection string. CIS Red Hat Enterprise Linux 5 Benchmark, v2.2.0 CIS Red Hat Enterprise Linux 6 Benchmark, v2.0.2 CIS Red Hat Enterprise Linux 7 Benchmark, v2.1.1 CIS SUSE Linux Enterprise 11 Benchmark, v2.0.0 CIS SUSE Linux Enterprise 12 Benchmark, v2.0.0 CIS Ubuntu Linux 14.04 LTS Benchmark, v2.0.0 CIS Ubuntu Linux 16.04 LTS Benchmark, v1.0.0 CIS Ubuntu Linux 18.04 LTS Benchmark, v1.0.0 NOTE : Any benchmarks which utilized CIS' proprietary Embedded Check Language (ECL) are not yet supported in CIS-CAT Pro Assessor v4. Further development will either implement these benchmarks using currently available scripting capabilities, or will be migrated to OVAL when platform coverage is expanded.","title":"CIS Benchmark Coverage"},{"location":"CoverageGuide/#platform-coverage-for-vulnerability-assessments","text":"Using the -vdd command-line option, CIS-CAT Pro Assessor v4 is able to download the latest vulnerability definitions from various repositories. A number of different platforms are officially supported by CIS-CAT Pro Assessor v4, including: Platform Downloaded From Microsoft Windows XP https://oval.cisecurity.org/repository/download/5.10/vulnerability Microsoft Windows 7 https://oval.cisecurity.org/repository/download/5.10/vulnerability Microsoft Windows 8 https://oval.cisecurity.org/repository/download/5.10/vulnerability Microsoft Windows 8.1 https://oval.cisecurity.org/repository/download/5.10/vulnerability Microsoft Windows 10 https://oval.cisecurity.org/repository/download/5.10/vulnerability Microsoft Windows Server 2003 https://oval.cisecurity.org/repository/download/5.10/vulnerability Microsoft Windows Server 2008 https://oval.cisecurity.org/repository/download/5.10/vulnerability Microsoft Windows Server 2008 R2 https://oval.cisecurity.org/repository/download/5.10/vulnerability Microsoft Windows Server 2012 https://oval.cisecurity.org/repository/download/5.10/vulnerability Microsoft Windows Server 2012 R2 https://oval.cisecurity.org/repository/download/5.10/vulnerability Microsoft Windows Server 2016 https://oval.cisecurity.org/repository/download/5.10/vulnerability Red Hat Enterprise Linux https://www.redhat.com/security/data/oval SuSE Linux Enterprise Server 9 https://support.novell.com/security/oval SuSE Linux Enterprise Server 10 https://support.novell.com/security/oval SuSE Linux Enterprise Server 11 https://support.novell.com/security/oval SuSE Linux Enterprise Server 12 https://support.novell.com/security/oval Ubuntu Linux 12.04 https://people.canonical.com/~ubuntu-security/oval Ubuntu Linux 14.04 https://people.canonical.com/~ubuntu-security/oval Ubuntu Linux 16.04 https://people.canonical.com/~ubuntu-security/oval Ubuntu Linux 18.04 https://people.canonical.com/~ubuntu-security/oval","title":"Platform Coverage for Vulnerability Assessments"},{"location":"CoverageGuide/#oval-capabilities","text":"International in scope and free for public use, OVAL is an information security community effort to standardize how to assess and report upon the machine state of computer systems. OVAL includes a language to encode system details, and an assortment of content repositories held throughout the community. Tools and services that use OVAL for the three steps of system assessment \u2014 representing system information, expressing specific machine states, and reporting the results of an assessment \u2014 provide enterprises with accurate, consistent, and actionable information so they may improve their security. Use of OVAL also provides for reliable and reproducible information assurance metrics and enables interoperability and automation among security tools and services.","title":"OVAL Capabilities"},{"location":"CoverageGuide/#platform-independent","text":"Test Name Implemented? Notes Environment Variable ( 5.8) Y Environment Variable (5.8+) N In development Family Y File Hash ( 5.8) Y File Hash (5.8+) Y LDAP ( 5.7) Y LDAP (5.7+) N Deprecated SQL ( 5.7+) N Deprecated SQL (5.7+) Y Text File Content ( 5.4) Y Text File Content (5.4+) Y Unknown Y Variable Y XML File Content Y","title":"Platform Independent"},{"location":"CoverageGuide/#microsoft-windows","text":"Test Name Implemented? Notes Access Token Y Active Directory ( 5.7) N On roadmap Active Directory (5.7+) N In Development Audit Event Policy Y Audit Event Policy Subcategories Y Cmdlet Y DNSCache N On roadmap File Y File Audited Permissions ( 5.3) Y File Audited Permissions (5.3+) Y File Effective Rights ( 5.3) Y File Effective Rights (5.3+) Y Group Y Group SID Y Interface Y Junction Y License Y Lockout Policy Y Metabase N NTUser N On roadmap Password Policy Y PEHeader Y Port Y Printer Effective Rights N Process ( 5.8) Y Process (5.8+) Y Registry Y Registry Key Audited Permissions ( 5.3) Y Registry Key Audited Permissions (5.3+) Y Registry Key Effective Rights ( 5.3) Y Registry Key Effective Rights (5.3+) Y Service Y Service Effective Rights Y Shared Resource Y Shared Resource Audited Permissions Y Shared Resource Effective Rights Y SID Y SID SID Y System Metric Y UAC Y User Y User Rights Y User SID ( 5.5) Y User SID (5.5+) Y Volume Y WMI ( 5.7) Y WMI (5.7+) Y WUA Update Searcher Y","title":"Microsoft Windows"},{"location":"CoverageGuide/#unix","text":"Test Name Implemented? Notes DNSCache N On roadmap File Y File Extended Attribute Y Gconf Y Inetd Y Interface Y Password Y Process ( 5.8) N On roadmap Process (5.8+) Y Routing Table N On roadmap Runlevel Y SCCS N On roadmap Shadow Y Symlink Y Sysctl Y Uname Y Xinetd Y","title":"Unix"},{"location":"CoverageGuide/#linux","text":"Test Name Implemented? Notes AppArmor Status Y DpkgInfo Y IfListeners N On roadmap Inet Listening Servers Y Partition Y RPM Info Y RPM Verify N On roadmap RPM Verify File N On roadmap RPM Verify Package N On roadmap SELinux Booleans Y SELinux Security Context N On roadmap Slackware PkgInfo N On roadmap Systemd Unit Dependency N On roadmap Systemd Unit Property Y","title":"Linux"},{"location":"CoverageGuide/#mac-osx","text":"Test Name Implemented? Notes Account Info Y Authorization DB Y CoreStorage N In development DiskUtil N In development Gatekeeper Y Inet Listening Servers ( 5.10) N In development Inet Listening Servers (5.10+) N In development Keychain N In development Launchd Y Nvram N In development Plist ( 5.10) Y Plist (5.10) Y Plist (5.11+) Y Pwpolicy ( 5.9) N In development Pwpolicy (5.9+) N In development Rlimit Y Software Update N In development System Profiler N In development System Setup N In development","title":"Mac OSX"},{"location":"CoverageGuide/#cisco-asa","text":"Test Name Implemented? Notes ACL N In development Class Map N In development Interface N In development Line N In development Policy Map N In development Service Policy N In development SNMP Host N In development SNMP Group N In development SNMP User N In development TCP Map N In development Version N In development","title":"Cisco ASA"},{"location":"CoverageGuide/#cisco-ios","text":"Test Name Implemented? Notes ACL Y Partial implementation BGP Neighbor Y Global Y Interface Y Line Y Router Y Routing Protocol Auth. Intf. Y Section Y SNMP Y SNMP Community Y SNMP Group Y SNMP Host Y SNMP User Y SNMP View Y Tclsh Y Version ( 5.5) Y Version (5.5+) Y","title":"Cisco IOS"},{"location":"CoverageGuide/#microsoft-iis-extension","text":"Test Name Implemented? Notes Application Host Config Y Application Pool Y Site Bindings Y System Web Y Web Config Y","title":"Microsoft IIS (Extension)"},{"location":"CoverageGuide/#vmware-esxi-extension","text":"Test Name Implemented? Notes VMHost Acceptance Level N In development VMHost VIB N In development VMHost Module N In development VMHost Coredump N In development VMHost Web Server SSL N In development VMHost Authentication N In development VMHost Account N In development VMHost SNMP N In development VMHost Advanced Setting N In development VMHost Service N In development VMHost NTP Server N In development VMHost Lockdown N In development VMHost Firewall Exception N In development VMHost Bus Adapter N In development VMHost iSCSI Host Bus Adapter N In development VMHost vSwitch Policy N In development VM Advanced Setting N In development VM Device N In development VM Hard Disk Device N In development VM Resource Config N In development Virtual Port Group N In development","title":"VMware ESXi (Extension)"},{"location":"CoverageGuide/#other","text":"Test Name Implemented? Notes Shell Command Y Extension, Platform Independent Invalid User Home Directory Ownership Y Extension, Linux","title":"Other"},{"location":"CoverageGuide/#scripting-capabilities","text":"CIS-CAT Pro Assessor implements the Script Check Engine (SCE) check system, initially introduced as part of the OpenSCAP project. Using SCE in XCCDF documents allows administrators to use already-created scripts written in Bash, Windows Batch files, PowerShell, VBScript, etc. in benchmark recommendations. CIS-CAT Pro Assessor supports using SCE usage with the following scripting languages: bash PowerShell Windows batch scripts VBScript","title":"Scripting Capabilities"},{"location":"CoverageGuide/#cis-embedded-check-language-ecl","text":"CIS-CAT Pro Assessor contains minimal implementation of CIS' proprietary Embedded Check Language (ECL). A subset of the total available functionality has been developed, in order to support both local and remote assessment of Apple OSX benchmarks. The following ECL constructs have been implemented: File Content Shell Command Platform Note that further ECL implementation is tentative and may not be included in future releases.","title":"CIS Embedded Check Language (ECL)"},{"location":"LicenseInformation/","text":"CIS-CAT Pro Assessor License Information NOTE: CIS-CAT Pro Assessor v4 is currently in BETA and this documentation will change as a result of ongoing testing and feedback. Until the official release of CIS-CAT Pro Assessor v4, please consider this document fluid. Introduction This document provides information regarding terms of use for CIS-CAT Pro Assessor, along with identification and documentation of license information for any 3rd-party libraries used in the tool. CIS Terms of Use TBD Third-Party Licenses The following 3rd-party libraries are bundled with CIS-CAT Pro Assessor v4. Information regarding the license and links to further information can be found in the table below. Library Version License License Link Groovy 2.5.1 Apache 2.0 https://github.com/apache/groovy/blob/master/LICENSE winrm4j 0.5.0 Apache 2.0 https://github.com/cloudsoft/winrm4j/blob/master/LICENSE smbj 0.8.0 Apache 2.0 https://github.com/hierynomus/smbj/blob/master/LICENSE_HEADER MapDB 3.0.2 Apache 2.0 https://github.com/jankotek/mapdb/blob/master/LICENSE.txt Apache Commons IO 2.4 Apache 2.0 https://github.com/apache/commons-io/blob/master/LICENSE.txt Apache Commons CLI 1.4 Apache 2.0 https://github.com/apache/commons-cli/blob/master/LICENSE.txt HTTP Client Framework for Groovy 0.7.1 Apache 2.0 https://github.com/jgritman/httpbuilder GPars 1.2.1 Apache 2.0 https://github.com/GPars/GPars/blob/master/LICENSE.txt jPowerShell 2.1 Apache 2.0 https://github.com/profesorfalken/jPowerShell/blob/master/LICENSE Logback Classic Module 1.1.7 LGPL 2.1 https://github.com/qos-ch/logback/blob/master/LICENSE.txt Logback Core Module 1.1.7 LGPL 2.1 https://github.com/qos-ch/logback/blob/master/LICENSE.txt MariaDB Java Client 1.5.6 LGPL 2.1 https://github.com/MariaDB/mariadb-connector-j/blob/master/LICENSE UnboundID LDAP SDK for Java 4.0.3 LGPL 2.1 https://github.com/pingidentity/ldapsdk/blob/master/LICENSE-UnboundID-LDAPSDK.txt jni4net 0.8.8.0 MIT https://github.com/jni4net/jni4net slf4j 1.7.25 MIT https://github.com/qos-ch/slf4j/blob/master/LICENSE.txt Saxon 9.1.0.8 Mozilla Public License 1.0 http://www.saxonica.com/license/license.xml Jsch 0.1.54 BSD http://www.jcraft.com/jsch/LICENSE.txt PostgreSQL JDBC Driver 42.2.4 PostgreSQL https://www.postgresql.org/about/licence/ Oracle JDBC Driver 11.2.0.4.0 Oracle Technology License http://www.oracle.com/technetwork/licenses/distribution-license-152002.html","title":"3rd-Party Licenses"},{"location":"LicenseInformation/#cis-cat-pro-assessor-license-information","text":"NOTE: CIS-CAT Pro Assessor v4 is currently in BETA and this documentation will change as a result of ongoing testing and feedback. Until the official release of CIS-CAT Pro Assessor v4, please consider this document fluid.","title":"CIS-CAT Pro Assessor License Information"},{"location":"LicenseInformation/#introduction","text":"This document provides information regarding terms of use for CIS-CAT Pro Assessor, along with identification and documentation of license information for any 3rd-party libraries used in the tool.","title":"Introduction"},{"location":"LicenseInformation/#cis-terms-of-use","text":"TBD","title":"CIS Terms of Use"},{"location":"LicenseInformation/#third-party-licenses","text":"The following 3rd-party libraries are bundled with CIS-CAT Pro Assessor v4. Information regarding the license and links to further information can be found in the table below. Library Version License License Link Groovy 2.5.1 Apache 2.0 https://github.com/apache/groovy/blob/master/LICENSE winrm4j 0.5.0 Apache 2.0 https://github.com/cloudsoft/winrm4j/blob/master/LICENSE smbj 0.8.0 Apache 2.0 https://github.com/hierynomus/smbj/blob/master/LICENSE_HEADER MapDB 3.0.2 Apache 2.0 https://github.com/jankotek/mapdb/blob/master/LICENSE.txt Apache Commons IO 2.4 Apache 2.0 https://github.com/apache/commons-io/blob/master/LICENSE.txt Apache Commons CLI 1.4 Apache 2.0 https://github.com/apache/commons-cli/blob/master/LICENSE.txt HTTP Client Framework for Groovy 0.7.1 Apache 2.0 https://github.com/jgritman/httpbuilder GPars 1.2.1 Apache 2.0 https://github.com/GPars/GPars/blob/master/LICENSE.txt jPowerShell 2.1 Apache 2.0 https://github.com/profesorfalken/jPowerShell/blob/master/LICENSE Logback Classic Module 1.1.7 LGPL 2.1 https://github.com/qos-ch/logback/blob/master/LICENSE.txt Logback Core Module 1.1.7 LGPL 2.1 https://github.com/qos-ch/logback/blob/master/LICENSE.txt MariaDB Java Client 1.5.6 LGPL 2.1 https://github.com/MariaDB/mariadb-connector-j/blob/master/LICENSE UnboundID LDAP SDK for Java 4.0.3 LGPL 2.1 https://github.com/pingidentity/ldapsdk/blob/master/LICENSE-UnboundID-LDAPSDK.txt jni4net 0.8.8.0 MIT https://github.com/jni4net/jni4net slf4j 1.7.25 MIT https://github.com/qos-ch/slf4j/blob/master/LICENSE.txt Saxon 9.1.0.8 Mozilla Public License 1.0 http://www.saxonica.com/license/license.xml Jsch 0.1.54 BSD http://www.jcraft.com/jsch/LICENSE.txt PostgreSQL JDBC Driver 42.2.4 PostgreSQL https://www.postgresql.org/about/licence/ Oracle JDBC Driver 11.2.0.4.0 Oracle Technology License http://www.oracle.com/technetwork/licenses/distribution-license-152002.html","title":"Third-Party Licenses"},{"location":"UsersGuide/","text":"CIS-CAT Pro Assessor CLI User's Guide NOTE: CIS-CAT Pro Assessor v4 is currently in BETA and this documentation will change as a result of ongoing testing and feedback. Until the official release of CIS-CAT Pro Assessor v4, please consider this document fluid. Introduction The CIS-CAT Pro Assessor CLI is a command-line user interface, allowing users to assess target systems against various forms of machine-readable content. CIS-CAT Pro Assessor CLI is designed primarily to assess CIS Benchmark configuration recommendations but can also assess content written in conformance with the Security Content Automation Protocol (SCAP), as well as plain OVAL definition content. Remote Assessment Capability Arguably the most important feature to be included in CIS-CAT Pro Assessor v4 is the ability to assess remote endpoints. Providing appropriate connection information allows CIS-CAT Pro Assessor to establish a \"session\", execute commands, run scripts, and perform collection and evaluation for the remote endpoint. For Microsoft Windows endpoints, this \"session\" is established through the use of WinRM. For Unix/Linux and Cisco network device endpoints, CIS-CAT Pro Assessor establishes the \"session\" via SSH. Endpoints to be assessed must be configured appropriately to allow for remote access. Please see the CIS-CAT Pro Assessor Configuration Guide for more information. Cisco Configuration Assessment CIS-CAT Pro Assessor v4 includes the capability to assess Cisco networking devices in two ways. Users can choose to connect directly to an online network device, via SSH, using a privileged account and perform evaluations against the current running configuration. New to v4, users now have the ability to export device configurations, specifically the full output of the show tech-support command, to a file, and CIS-CAT Pro Assessor v4 can parse that output and perform the assessment. Specifying the path to the exported configuration file is through the \"session\" configurations. Detailed information on \"sessions\" can be found in the CIS-CAT Pro Assessor Configuration Guide . Deployment CIS-CAT Pro Assessor CLI is a simple Java-based application and as such, requires a Java Runtime Environment (JRE) at or above version 1.8, in order to execute. A suitable JRE may be installed to the machine on which CIS-CAT is installed, or may be located on a network share. As long as the machine executing the CIS-CAT Pro Assessor CLI application can access a suitable JRE, it may be used to run the tool. A note on benchmark coverage Many benchmarks which utilized CIS' proprietary Embedded Check Language (ECL) are not yet supported in CIS-CAT Pro Assessor v4, with the exception of the latest Apple OSX versions. Further development will either implement these benchmarks using currently available scripting capabilities, or will be migrated to OVAL when platform coverage is expanded. See the CIS-CAT Pro Assessor Coverage Guide for the most up-to-date information regarding platform coverage. Using CIS-CAT Pro Assessor CLI Bundled with the application are two script files; a Microsoft Windows batch script, Assessor-CLI.bat and a Unix/Linux shell script, Assessor-CLI.sh . These scripts serve as the entry point to the application. Any examples included in this user's guide will utilize the Microsoft Windows batch script, but usage of the Unix/Linux shell script can be substituted. Command Line Options CIS-CAT Pro Assessor CLI can perform a variety of functions related to both benchmark and vulnerability assessments. The myriad command-line options allow for combined usage to initiate these functions. Basic Options Basic operation of CIS-CAT Pro Assessor CLI allows a user to get help, list available content, or to interactively step through the selection of a benchmark and profile prior to executing an assessment. Short Option Long Option Argument(s) Description -h --help N/A Display CIS-CAT Pro Assessor help output. -l --list N/A List the benchmarks available for assessment. -v --verbose N/A Enable more verbose output when combined with the -l option, specifically displaying the full filepath to the benchmark, for later assessment using the -b option. -i --interactive N/A Execute the Assessor in \"interactive\" mode specifically for benchmark assessments, allowing the user to manually select a benchmark and profile for assessment. Based on the selected benchmark, the user may be required to enter \"interactive values\" which are then used by the assessment engine. -o --definitions N/A Execute the Assessor in \"interactive\" mode specifically for the manual selection and evaluation of OVAL Definitions files, and (optionally) selecting and associating an OVAL Variables file as well. -d --startingDir DIRECTORY Configure the relative root folder from which other options, such as benchmarks, can be found. -cfg --config-xml CONFIGURATION XML FILE Execute CIS-CAT Pro Assessor using configuration information found in the CONFIGURATION XML FILE . This file allows users to override user properties, configure interactive values, setup sessions and outline the various assessments to be performed. See the \"Using a Configuration XML File\" section below for more information and examples regarding the structure and options for the XML configuration file. Examples Simply display the CIS-CAT Pro Assessor help information: Assessor-CLI.bat -h List all available benchmarks: Assessor-CLI.bat -l List all available benchmarks relative to a specific folder: Assessor-CLI.bat -l -d C:\\CIS\\My-Benchmarks List All Available Benchmarks (including path information for use with the -b option) Assessor-CLI.bat -l -v Execute an assessment of a benchmark/data-stream in \"interactive\" mode: Assessor-CLI.bat -i Execute an assessment of a benchmark/data-stream in \"interactive\" mode, selecting a benchmark from a location relative to a specific folder: Assessor-CLI.bat -i -d C:\\CIS\\My-Benchmarks Execute an assessment of an OVAL Definitions file in \"interactive\" mode: Assessor-CLI.bat -i -o Execute an assessment of an OVAL Definitions file in \"interactive\" mode, selecting the definitions file from a location relative to a specific folder: Assessor-CLI.bat -i -o -d C:\\CIS\\My-Benchmarks Execute an assessment or set of assessments using information found in a saved configuration XML file: Assessor-CLI.bat -cfg C:\\CIS\\assessment-configuration.xml Benchmark/Data-Stream Collection Options The benchmark and data-stream collection options provide users the ability to select specific content for assessment. The -b option gives the user the choice to specify the path to either the XCCDF file (containing the Benchmark element) or the Data-stream collection file. Using the -p option, users can select a specific configuration profile to assess, using either the profile's ID or the profile's title/name. Short Option Long Option Argument Description -b --benchmark BMK-OR-DSC Specify either the full filepath to the assessment content or a path relative to the starting directory. The BMK-OR-DSC argument represents either a Benchmark XCCDF file, or the SCAP 1.2-formatted Data-stream Collection file. -dm --data-stream DATA-STREAM Used only when the -b option selects a data-stream-collection document, the -dm option specifies, within the collection, the ID of the data-stream to be assessed. -cl --checklist CHECKLIST Used only in conjunction with the -dm option, the -cl option specifies, within the data-stream, the ID of the checklist (benchmark) to be assessed. -p --profile PROFILE Specify either a profile name, such as Level-1 , or the profile ID, such as xccdf_org.cisecurity.benchmarks_profile_Level_1 . Note that when using the profile name, if any spaces occur, the entire profile name must be wrapped in double-quotes, such as \"Level 2\" Examples Execute an assessment against the CIS Microsoft Windows 10 benchmark, using the relative path to the benchmark file, automatically selecting the first profile: Assessor-CLI.bat -b benchmarks\\CIS_Microsoft_Windows_10_Enterprise_Release_1703_Benchmark_v1.3.0-xccdf.xml Execute an assessment against the CIS Microsoft Windows 10 benchmark, using the relative path to the benchmark file, selecting a specific profile by name: Assessor-CLI.bat -b benchmarks\\CIS_Microsoft_Windows_10_Enterprise_Release_1703_Benchmark_v1.3.0-xccdf.xml -p \"Level 1 + BitLocker\" Execute an assessment against the CIS Microsoft Windows 10 benchmarks, using an absolute path to the benchmark file, automatically selecting the first profile: Assessor-CLI.bat -b C:\\CIS\\MyBenchmarks\\CIS_Microsoft_Windows_10_Enterprise_Release_1703_Benchmark_v1.3.0-xccdf.xml Execute an assessment against the CIS Microsoft Windows Server 2016 data-stream collection, using the default first data-stream, default first checklist, and default first profile: Assessor-CLI.bat -b benchmarks\\CIS_Microsoft_Windows_Server_2016_Benchmark_v1.0.0-datastream.xml Execute an assessment against the CIS Microsoft Windows Server 2016 data-stream collection, using a specific data-stream, the default first checklist, and default first profile: Assessor-CLI.bat -b benchmarks\\CIS_Microsoft_Windows_Server_2016_Benchmark_v1.0.0-datastream.xml -dm scap_org.cisecurity_datastream_1.0.0_CIS_Microsoft_Windows_Server_2016_Benchmark Execute an assessment against the CIS Microsoft Windows Server 2016 data-stream collection, using a specific data-stream, a specific checklist, and the default first profile: Assessor-CLI.bat -b benchmarks\\CIS_Microsoft_Windows_Server_2016_Benchmark_v1.0.0-datastream.xml -dm scap_org.cisecurity_datastream_1.0.0_CIS_Microsoft_Windows_Server_2016_Benchmark -cl xccdf_org.cisecurity.benchmarks_benchmark_1.0.0_CIS_Microsoft_Windows_Server_2016_Benchmark Execute an assessment against the CIS Microsoft Windows Server 2016 data-stream collection, using a specific data-stream, a specific checklist and a specific profile: Assessor-CLI.bat -b benchmarks\\CIS_Microsoft_Windows_Server_2016_Benchmark_v1.0.0-datastream.xml -dm scap_org.cisecurity_datastream_1.0.0_CIS_Microsoft_Windows_Server_2016_Benchmark -cl xccdf_org.cisecurity.benchmarks_benchmark_1.0.0_CIS_Microsoft_Windows_Server_2016_Benchmark -p \"Level 1 - Member Server\" OVAL Definitions Assessment Options CIS-CAT Pro Assessor also has the ability to assess OVAL definitions files, such as vulnerability definitions downloaded from the OVAL repository. Using an OVAL Variables file also allows for the injection of \"external\" variable values into the assessment of OVAL definitions content. Short Option Long Option Argument Description -od --oval-definitions OVAL_DEFINITIONS Specify either the full filepath to an OVAL Definitions XML file, or a path relative to the starting directory. -ov --oval-variables OVAL_VARIABLES Only used in conjunction with the -od option, the -ov option specifies either the full filepath to an OVAL Variables XML file, or a path relative to the starting directory. Examples Execute an assessment against the Microsoft Windows 10 vulnerability definitions: Assessor-CLI.bat -od vulnerabilities\\microsoft_windows_10.xml Execute an assessment against the Microsoft Windows 10 vulnerability definitions, producing both an OVAL Result XML file, and an HTML report: Assessor-CLI.bat -od vulnerabilities\\microsoft_windows_10.xml -html Execute an assessment against an OVAL Definitions file containing \"external\" variables, using an OVAL Variables file to provide those variable values: Assessor-CLI.bat -od C:\\CIS\\oval_definitions.xml -ov C:\\CIS\\oval_variables.xml Execute an assessment against an OVAL Definitions file containing \"external\" variables, using an OVAL Variables file to provide those variable values, producing both an OVAL Results XML file, and an HTML report: Assessor-CLI.bat -od C:\\CIS\\oval_definitions.xml -ov C:\\CIS\\oval_variables.xml -html Reporting Options A number of options exist for generating assessment results. When a benchmark or data-stream collection is assessed, the Asset Reporting Format (ARF) results are generated. The ARF report is an XML document containing Asset Information for the endpoint under assessment, the benchmark/data-stream that was assessed, system characteristics, and assessment results. When OVAL Definitions are assessed, an \"OVAL results with system characteristics\" XML document is produced by default. These reports are automatically generated and cannot be disabled. These XML documents are designed to be either uploaded directly to CIS-CAT Pro Dashboard, or transformed into more human-readable HTML, CSV or plain-text documents. The following table summarizes a number of options controlling which reports to generate, naming of reports, and functionality allowing users to upload reports to a URL, such as CIS-CAT Pro Dashboard. Short Option Long Option Argument Description -rd --reports-dir DIRECTORY Configure the report destination folder, allowing users to configure the location to which result reports are written. -rp --report-prefix PREFIX Configure the \"front\" portion of the report name generated by the tool. Every report will automatically be of the format [report-prefix]-[timestamp].[extension] such as CIS-CAT-TEST-Windows10-20171218T173220Z.xml . -html N/A N/A Generate an HTML report. The report name will be of the format [report-prefix]-[timestamp].html -csv N/A N/A Generate a CSV report. The report name will be of the format [report-prefix]-[timestamp].csv -txt N/A N/A Generate a plain text report. The report name will be of the format [report-prefix]-[timestamp].txt -u --url REPORTS-URL Specify a URL to which Assessor results are uploaded, using HTTP(S) POST. -ui --ignore-warnings N/A Indicate that, when uploading results to a URL via the -u option, any SSL certificate warnings should be ignored. -narf --no-arf N/A This option disables the generation of Asset Reporting Format (ARF) XML results. The ARF report is the default report generated by the Assessor. -nrf --no-report-file N/A This option disables generation of a results report file. When utilizing the -u option, Assessor results are uploaded to the supplied URL. In that use-case, report files are generally not needed. Examples Execute CIS-CAT Pro Assessor CLI interactively, generating both an Asset Reporting Format result (by default) and an HTML report, saving them to the default reports folder: Assessor-CLI.bat -i -html Execute an assessment against the CIS Microsoft Windows 10 benchmark, using the relative path to the benchmark file, automatically selecting the first profile. Generate both the Asset Reporting Format (ARF) by default and an HTML report. Save the reports to a specific reports folder: Assessor-CLI.bat -b benchmarks\\CIS_Microsoft_Windows_10_Enterprise_Release_1703_Benchmark_v1.3.0-xccdf.xml -html -rd C:\\CIS\\custom\\reports Execute an assessment against the CIS Microsoft Windows 10 benchmark, using the relative path to the benchmark file, automatically selecting the first profile. Generate both the Asset Reporting Format (ARF) by default and an HTML report. Save the reports to the default reports folder, but name the reports in a custom format: Assessor-CLI.bat -b benchmarks\\CIS_Microsoft_Windows_10_Enterprise_Release_1703_Benchmark_v1.3.0-xccdf.xml -html -rp \"CCPA-Windows10\" Execute an assessment against the CIS Microsoft Windows 10 benchmark, using the relative path to the benchmark file, automatically selecting the first profile. Configure the application to not generate any physical report files, but to upload the results to CIS-CAT Pro Dashboard, ignoring any SSL certificate warnings: Assessor-CLI.bat -b benchmarks\\CIS_Microsoft_Windows_10_Enterprise_Release_1703_Benchmark_v1.3.0-xccdf.xml -nrf -u https://ccpd.example.org/CCPD/api/reports/upload -ui Miscellaneous Options Short Option Long Option Argument Description -vdd --vulnerability-definitions N/A Download the latest supported vulnerability definitions. See the CIS-CAT Pro Assessor Coverage Guide for the most up-to-date information regarding vulnerability definitions platform coverage. Vulnerability definitions files are saved into the application's vulnerabilities folder, i.e. C:\\CIS\\Assessor-CLI\\vulnerabilities . -sessions --sessions SESSIONS.PROPERTIES The -sessions option allows users to configure multiple endpoints for assessment of a benchmark. The sessions.properties file configures CIS-CAT Pro Assessor for the assessment of remote endpoints by specifying remote hosts, ports, and credentials which the application will use for connection, collection and evaluation of benchmark recommendations and/or vulnerabilities. See \"Remote Assessment Capability\" below for more information. If no sessions.properties file exists or no connections are configured in the file, CIS-CAT Pro Assessor CLI will assess the local machine. -props --properties PROPERTIES-FILE The CIS-CAT Pro Assessor CLI user properties file defaults many runtime properties used during the assessment process. These properties may be customized per assessment or per endpoint, by creating individual properties files, and specifying either the full filepath or a path relative to the working directory. If this option is not specified, CIS-CAT Pro Assessor CLI will load a default properties file named assessor-cli.properties located in the config folder of the application installation. -D N/A Property=Value Instead of creating a new properties file for unique assessments, individual user properties may be specified using the -D option together with a property=value pair. This allows an assessment to only override specific user properties when only a small number differ from the defaults. -test --test N/A The -test option allows the user to perform connection tests on any sessions configured to execute during the assessments. These sessions may be loaded from a configuration XML file ( -cfg ) or from a sessions.properties file ( -sessions ). When specified, connectivity tests are performed and reported to the user on the CIS-CAT Pro Assessor console. Once completed, CIS-CAT Pro Assessor exits. When the -test option is supplied, no assessments take place; only the connectivity tests. -q --quiet N/A Enable the Assessor to execute in \"quiet mode\", causing the suppression of any assessment status information from being written to the console. Examples Download the latest vulnerability definitions: Assessor-CLI.bat -vdd Download the latest vulnerability definitions when using an HTTPS Proxy: Assessor-CLI.bat -vdd -D https.proxyHost=PROXY_HOSTNAME_OR_IP -D https.proxyPort=PROXY_PORT Download the latest vulnerability definitions when using an HTTP Proxy: Assessor-CLI.bat -vdd -D http.proxyHost=PROXY_HOSTNAME_OR_IP -D http.proxyPort=PROXY_PORT Execute a vulnerability assessment for the Microsoft Windows Server 2012 R2 platform, producing both an OVAL Result XML file, and an HTML report: Assessor-CLI.bat -od vulnerabilities\\microsoft_windows_server_2012_r2.xml -html Execute an assessment against the CIS Microsoft Windows 10 benchmark, using the relative path to the benchmark file, automatically selecting the first profile, assessing a number of remote machines, configured in a specific session configuration file: Assessor-CLI.bat -b benchmarks\\CIS_Microsoft_Windows_10_Enterprise_Release_1703_Benchmark_v1.3.0-xccdf.xml -sessions C:\\CIS\\sessions\\windows_10_machines.properties Execute an assessment against the CIS Oracle Database 11g R2 benchmark, selecting the Windows Server Host OS profile, and configuring the required \"interactive\" values: Assessor-CLI.bat -b benchmarks\\CIS_Oracle_Database_11g_R2_Benchmark_v2.2.0-xccdf.xml -p \"Level 1 - Windows Server Host OS\" -D xccdf_org.cisecurity_value_jdbc.url=jdbc:oracle:thin:user/s3cr3t@DBHOST:1521:devdb -D xccdf_org.cisecurity_value_listener.ora=C:\\product\\oracle\\network\\admin\\listener.ora Using a customized properties file defining session connections, test the connectivity of each session and exit: Assessor-CLI.bat -sessions config\\test-sessions.properties -test Execute the Assessor, against the CIS Microsoft Windows 10 benchmark, in \"quiet mode\" Assessor-CLI.bat -b benchmarks\\CIS_Microsoft_Windows_10_Enterprise_Release_1703_Benchmark_v1.3.0-xccdf.xml -q Configuring Interactive Values A number of benchmarks supported by/bundled with CIS-CAT Pro Assessor require manual interaction by the user in order to configure specific values used during the assessment. These \"interactive values\" will be presented to the user during a manual execution of the assessment, but will block the completion of the assessment if it is being executed off-hours, or as part of an automated script. CIS-CAT Pro Assessor provides a mechanism for these \"interactive values\" to be configured using a properties file, thus removing the burden of entering these values manually. This configuration requires knowledge of the value's id attribute within the benchmark or data-stream collection component. The CIS-CAT Pro Assessor Coverage Guide provides a listing, for each applicable benchmark, for any \"interactive value\" id attributes. Once known, a user can modify the assessor-cli.properties file to specify the value: xccdf_org.cisecurity_value_jdbc.url=jdbc:oracle:thin:system/manager@dbhost:1521:orcl When CIS-CAT Pro Assessor executes, the program will (by default) attempt to load properties contained in the config\\assessor-cli.properties . A second method to configure \"interactive values\" is to utilize the -D Property=Value command-line option. This allows the user to configure a single property at a time when executing, therefore eliminating the potential need for multiple properties files. Configuring this option on the command-line is straightforward, where the property name is the id attribute of the \"interactive value\" and the property value is configured: Assessor-CLI.bat -b benchmarks\\CIS_Oracle_Database_11g_R2_Benchmark_v2.2.0-xccdf.xml -p \"Level 1 - Windows Server Host OS\" -D xccdf_org.cisecurity_value_jdbc.url=jdbc:oracle:thin:user/s3cr3t@DBHOST:1521:devdb Using a Configuration XML File CIS-CAT Pro Assessor can be executed using the -cfg option, and specifying a configuration XML file. This XML file allows user to configure sessions, assessments, interactive values, user properties, and reporting options all in a single file. This configuration XML file essentially allows for multiple benchmark assessments against multiple endpoints both local and/or remote. An XML schema is included in the CIS-CAT Pro Assessor CLI bundle, along with a sample configuration file. Configuration XML Elements The root element of the configuration XML file is configuration , and utilizes a default namespace URI of http://cisecurity.org/ccpa/config . This namespace URI must be specified or else validation of the configuration XML file will fail. The root of any XML configuration file should appear as follows: configuration xmlns=\"http://cisecurity.org/ccpa/config\" All other elements must be contained within the configuration element. The following sections describe the elements that are available for configuration through the XML file: CIS-CAT Pro Assessor \"starting directory\" starting_dir C:\\Projects\\CIS-CAT\\Assessor-CLI /starting_dir The starting_dir element is optional and contains a value noting the base directory from which any relative paths are specified (such as the location of an XCCDF benchmark). This element is the equivalent of the -d command-line option. If this element is not present in the configuration file, the default starting directory, the folder in which CIS-CAT Pro Assessor is installed, is used. Vulnerability Definitions Download vulnerability_definitions download=\"(true|false)\"/ The vulnerability_definitions element contains a single attribute, download . If this attribute's value is true , CIS-CAT Pro Assessor will download the latest vulnerability definitions. This element/attribute is equivalent to the -vdd command-line option. If this element is not present in the configuration file, or the download attribute is set to false , vulnerability definitions will not be downloaded. Sessions The sessions element configures each individual connection to either the local host or a remote endpoint. An attribute of the sessions element, test indicates whether this configuration file is meant to test the connectivity of each session only. When the test attribute is true , connectivity tests will take place, and CIS-CAT Pro Assessor will then exit. No other assessment processing will take place. !-- Session configurations referenced by the assessments -- sessions test=\"(true|false)\" !-- A \"connection\" to the local host -- session id=\"local\" type local /type tmp_path C:\\Temp /tmp_path /session !-- A connection to a remote Ubuntu instance using a private key file -- session id=\"aws-ubuntu\" type ssh /type host 11.22.33.44 /host port 22 /port user ubuntu /user identity C:\\Path\\To\\aws-ubuntu.ppk /identity tmp_path /path/to/temp/folder /tmp_path /session !-- A connection to a remote CentOS instance using a private key file secured with a passphrase -- session id=\"aws-centos\" type ssh /type host 1.2.3.4 /host port 22 /port user centos /user identity C:\\Path\\To\\aws-centos.ppk /identity identity_passphrase P@55phr@s3! /identity_passphrase tmp_path /path/to/temp/folder /tmp_path /session !-- A connection to a remote Windows instance using credentials -- session id=\"aws-2012r2\" type windows /type host AWS-WIN2012R2-AMI /host port 5986 /port user Administrator /user credentials P@ssw0rd12345 /credentials /session !-- A connection to a Cisco IOS device, using a private key file -- session id=\"cisco-ios1\" type ios /type host 55.66.77.88 /host port 22 /port user ciscoprivd /user identity C:\\Path\\To\\cisco-ios-private-key.ppk /identity enable_password 3n@bl3mePlz /enable_password /session /sessions Each session consists of a number of elements configuring the connection to the target endpoint: type : The session type indicates a \"flavor\" of the connection to the endpoint being assessed. A number of options exist for the type value, as noted in the CIS-CAT Pro Assessor Configuration Guide . local : The \"local\" session type indicates that the assessment(s) will be performed in a host-based manner. No further session information is required when using a \"local\" session. ssh : The \"ssh\" session type indicates the connection is to a remote Unix/Linux/Mac endpoint. This session type allows CIS-CAT Pro Assessor to utilize the host , port , user , and either credentials and/or identity (and optionally an identity_passphrase ) to create a SSH connection to the endpoint and use that SSH connection to execute the assessment. windows : The \"windows\" session type indicates (obviously) a connection to a remote Microsoft Windows endpoint. This session type allows CIS-CAT Pro Assessor to utilize the host , port , user , credentials to initiate a WinRM connection to the remote endpoint. ios : The \"ios\" session type indicates a connection to a remote Cisco IOS device, such as a router or switch. This session type allows CIS-CAT Pro Assessor to utilize the host , port , user , and either credentials and/or identity (and optionally an identity_passphrase ) to create a SSH connection to the endpoint and use that SSH connection to execute the assessment. host : The \"host\" element value is either the hostname or IP address of the endpoint to which this session will connect/assess. port : The \"port\" element value is the port number on which communication takes place. For ssh or ios connections, the default value for port is 22. For windows sessions, the default value is 5986. user : The \"user\" element value specifies the username used to log on to the remote endpoint. For ssh sessions, this user should be either root or a username with the ability to sudo , in order to elevate privileges to execute the required commands. For windows sessions, the user must be either an Administrator or a member of the Administrators group. For ios sessions, the user must be privileged and able to enter into \"enable\" mode on that device, using the enable_password value below. credentials : The \"credentials\" element identifies the user's password for logging on to the remote endpoint. Note that this XML file will then be storing users and passwords for remote endpoints, and should thus be secured as much as possible on the machine hosting CIS-CAT Pro Assessor. When the session type is either ssh or ios , the credentials element can be bypassed by logging into the remote endpoint using a private key file, the path of which is configured in the identity element. If a private key is used for authentication, the credentials element can either be left out of the session configuration, or included for use when commands must be executed with elevated privileges using sudo , and the credentials are required for that user. identity : The identity element specifies the full filepath to a private key file to be used for authenticating the user to the remote endpoint. When configuring a session , the identity may require the specification of the identity_passphrase in order for authentication to complete successfully. Note that for windows sessions, private key authentication is not currently supported. identity_passphrase : The identity_passphrase element contains credentials required to complete authentication using the private key specified in the identity element. enable_password : When authenticating a privileged user for ios sessions, the enable_password is mandatory. This element specifies the credentials which allow the privileged user to enter \"enable\" mode on the Cisco IOS device. tmp_path : Configure a custom \"temp\" directory location for use on the target endpoint. By default, the Assessor will use the \"temp\" folder location defined for that operating system, such as /tmp or C:\\Windows\\Temp . If a different folder should be used, for example because the /tmp partition is configured with -noexec , the tmp_path element should be included. Assessments The assessments element configures which assessment content will be evaluated, against which session that content will be assessed, any User properties specific to that assessment, and/or any \"interactive\" values to be applied to that assessment. assessments !-- XCCDF COLLECTIONS -- benchmark xccdf=\"benchmarks\\CIS_Ubuntu_Linux_16.04_LTS_Benchmark_v1.0.0-xccdf.xml\" profile=\"Level 1 - Workstation\" session-ref=\"aws-ubuntu\"/ benchmark xccdf=\"benchmarks\\CIS_Ubuntu_Linux_16.04_LTS_Benchmark_v1.0.0-xccdf.xml\" profile=\"Level 1 - Server\" session-ref=\"aws-ubuntu\"/ benchmark xccdf=\"benchmarks\\CIS_Microsoft_Windows_Server_2012_R2_Benchmark_v2.2.1-xccdf.xml\" profile=\"Level 1 - Member Server\" session-ref=\"aws-2012r2\" properties property name=\"ignore.platform.mismatch\" true /property /properties /benchmark benchmark xccdf=\"benchmarks\\CIS_Oracle_Database_11g_R2_Benchmark_v2.2.0-xccdf.xml\" profile=\"Level 1\" session-ref=\"aws-ubuntu\" interactive_values value id=\"xccdf_org.cisecurity_value_jdbc.url\" jdbc:oracle:thin:sys/passw0rd1@DB-SERVER:1521:ORCL /value value id=\"xccdf_org.cisecurity_value_listener.ora\" /opt/oracle/product/oracle11g/network/admin/listener.ora /value /interactive_values /benchmark !-- DATA-STREAM COLLECTIONS -- data-stream-collection collection=\"dsc-id\" data-stream=\"ds-id\" checklist=\"benchmark-id\" profile=\"profile-id-or-name\" session-ref=\"local\"/ !-- OVAL DEFINITIONS COLLECTIONS -- oval_definitions definitions=\"vulnerabilities\\microsoft_windows_10.xml\" session-ref=\"local\"/ oval_definitions definitions=\"definitions\\defs.xml\" variables=\"definitions\\vars.xml\" session-ref=\"local\"/ /assessments A number of elements may be configured, allowing various assessments against a number of different sessions: Assess an XCCDF Benchmark , selecting the first Profile : benchmark xccdf=\"benchmarks\\CIS_Ubuntu_Linux_16.04_LTS_Benchmark_v1.0.0-xccdf.xml\" session-ref=\"aws-ubuntu\"/ xccdf : The \"xccdf\" attribute defines the path (relative to the starting_dir or absolute) to the XCCDF file being assessed. session-ref : The \"session-ref\" attribute specifies the id of a session configured in the sessions configuration, described above. Assess an XCCDF Benchmark , selecting a named Profile : benchmark xccdf=\"benchmarks\\CIS_Ubuntu_Linux_16.04_LTS_Benchmark_v1.0.0-xccdf.xml\" profile=\"Level 1 Workstation\" session-ref=\"aws-ubuntu\"/ xccdf : The \"xccdf\" attribute defines the path (relative to the starting_dir or absolute) to the XCCDF file being assessed. profile : The \"profile\" attribute defines the configuration Profile, within the XCCDF, selected for assessment. The value of this attribute may be either the Profile title or id specified in the Benchmark XCCDF. session-ref : The \"session-ref\" attribute specifies the id of a session configured in the sessions configuration, described above. Assess an XCCDF Benchmark , selecting a named Profile, and configuring specific assessment properties : benchmark xccdf=\"benchmarks\\CIS_Microsoft_Windows_Server_2012_R2_Benchmark_v2.2.1-xccdf.xml\" profile=\"Level 1 Member Server\" session-ref=\"aws-2012r2\" properties property name=\"ignore.platform.mismatch\" true /property /properties /benchmark xccdf : The \"xccdf\" attribute defines the path (relative to the starting_dir or absolute) to the XCCDF file being assessed. profile : The \"profile\" attribute defines the configuration Profile, within the XCCDF, selected for assessment. The value of this attribute may be either the Profile title or id specified in the Benchmark XCCDF. session-ref : The \"session-ref\" attribute specifies the id of a session configured in the sessions configuration, described above. properties : The \"properties\" element serves as a container for individual property elements. A properties element must contain 1..n property element(s). property : A \"property\" defines a name/value pair, configuring a single user property named by the value of the name attribute. The value of the property is the content of the element. An individual property is the equivalent of using the -D name=value command-line option, or a property defined in the \"assessor-cli.properties\" file, located in the config folder. Assess an XCCDF Benchmark , selecting a named Profile, configuring specific values normally requested from the user : benchmark xccdf=\"benchmarks\\CIS_Oracle_Database_11g_R2_Benchmark_v2.2.0-xccdf.xml\" profile=\"Level 1\" session-ref=\"aws-ubuntu\" interactive_values value id=\"xccdf_org.cisecurity_value_jdbc.url\" jdbc:oracle:thin:sys/passw0rd1@DB-SERVER:1521:ORCL /value value id=\"xccdf_org.cisecurity_value_listener.ora\" /opt/oracle/product/oracle11g/network/admin/listener.ora /value /interactive_values /benchmark xccdf : The \"xccdf\" attribute defines the path (relative to the starting_dir or absolute) to the XCCDF file being assessed. profile : The \"profile\" attribute defines the configuration Profile, within the XCCDF, selected for assessment. The value of this attribute may be either the Profile title or id specified in the Benchmark XCCDF. session-ref : The \"session-ref\" attribute specifies the id of a session configured in the sessions configuration, described above. interactive_values : The \"interactive_values\" element serves as a container for individual value elements. An interactive_values element must contain 1..n value element(s). value : A \"value\" defines an id/value pair, configuring a single interactive value identified by the id attribute. This id attribute should match the id of a Value element in the XCCDF that is noted as interactive=\"true\" . The value of the value is the content of the element. An individual value is the equivalent of using the -D name=value command-line option, or a property defined in the \"assessor-cli.properties\" file, located in the config folder. Assess a SCAP data-stream-collection , selecting the first data-stream, checklist, and profile : data-stream-collection collection=\"collections\\collection.xml\" session-ref=\"local\"/ collection : The \"collection\" attribute defines the path (relative to the starting_dir or absolute) to the SCAP 1.2 data-stream collection file being assessed. session-ref : The \"session-ref\" attribute specifies the id of a session configured in the sessions configuration, described above. Assess a SCAP data-stream-collection , selecting a named data-stream, the first checklist, and first profile : data-stream-collection collection=\"collections\\collection.xml\" data-stream=\"ds-id\" checklist=\"benchmark-id\" profile=\"profile-id-or-name\" session-ref=\"local\"/ collection : The \"collection\" attribute defines the path (relative to the starting_dir or absolute) to the SCAP 1.2 data-stream collection file being assessed. data-stream : The \"data-stream\" attribute specifies the id of the data-stream , contained in the collection, to be selected for assessment. session-ref : The \"session-ref\" attribute specifies the id of a session configured in the sessions configuration, described above. Assess a SCAP data-stream-collection , selecting a named data-stream, a named checklist, and the first profile : data-stream-collection collection=\"collections\\collection.xml\" data-stream=\"ds-id\" checklist=\"benchmark-id\" profile=\"profile-id-or-name\" session-ref=\"local\"/ collection : The \"collection\" attribute defines the path (relative to the starting_dir or absolute) to the SCAP 1.2 data-stream collection file being assessed. data-stream : The \"data-stream\" attribute specifies the id of the data-stream , contained in the collection, to be selected for assessment. checklist : The \"checklist\" attribute specifies the id of the checklist to be assessed. A checklist is a component in the data-stream collection representing an XCCDF Benchmark . session-ref : The \"session-ref\" attribute specifies the id of a session configured in the sessions configuration, described above. Assess a SCAP data-stream-collection , selecting a named data-stream, a named checklist, and a named profile : data-stream-collection collection=\"collections\\collection.xml\" data-stream=\"ds-id\" checklist=\"benchmark-id\" profile=\"profile-id-or-name\" session-ref=\"local\"/ collection : The \"collection\" attribute defines the path (relative to the starting_dir or absolute) to the SCAP 1.2 data-stream collection file being assessed. data-stream : The \"data-stream\" attribute specifies the id of the data-stream , contained in the collection, to be selected for assessment. checklist : The \"checklist\" attribute specifies the id of the checklist to be assessed. A checklist is a component in the data-stream collection representing an XCCDF Benchmark . profile : The \"profile\" attribute defines the configuration Profile, within the checklist, selected for assessment. The value of this attribute may be either the Profile title or id specified in the Benchmark XCCDF. session-ref : The \"session-ref\" attribute specifies the id of a session configured in the sessions configuration, described above. Assess an oval_definitions file that does not include an oval_variables file : oval_definitions definitions=\"vulnerabilities\\microsoft_windows_10.xml\" session-ref=\"local\"/ definitions : The \"definitions\" attribute defines the path (relative to the starting_dir or absolute) to the OVAL Definitions file being assessed. Assess an oval_definitions file that includes an oval_variables file : oval_definitions definitions=\"definitions\\defs.xml\" variables=\"definitions\\vars.xml\" session-ref=\"local\"/ definitions : The \"definitions\" attribute defines the path (relative to the starting_dir or absolute) to the OVAL Definitions file being assessed. variables : The \"variables\" attribute defines the path (relative to the starting_dir or absolute) to the OVAL Variables file used in the assessment. Report Output Options The reports element contains a number of attributes controlling the output report formats, and sub-elements controlling report output directory, POST URL, and report naming. The html attribute value controls the generation of HTML reports, the csv attribute controls the generation of CSV reports, and the txt attribute controls the generation of plain-text reports. The no-arf attribute, when true , disables the generation of the Asset Reporting Format XML results. The no-report-file attribute, when true , overrides the other 3 attributes and disables the generation of any report files. Setting this attribute to true is intended to be used in conjunction with the reports_url element, which identifies a URL to which report output should be POST'ed. If the reports are POST'ed to the URL, they may not need to be generated and saved in file format. !-- Customize the folder to which CIS-CAT reports are saved. If not present, CIS-CAT will use the default reports location. -- reports_dir C:\\Projects\\CIS\\reports /reports_dir !-- POST the Asset Reporting Format or OVAL Results XML to a URL, ignoring SSL certificate warnings if specified -- reports_url ignore_certificate_warnings=\"true\" https://example.cisecurity.org/CCPD/api/reports/upload /reports_url !-- Override the default report name. Timestamp information will always be appended to the report_prefix -- reports_prefix CIS-CAT-DEV /reports_prefix /reports Various sub-elements are available to configure the destination folder for report files to be saved, URL's to which reports can be uploaded, and naming of reports: reports_dir C:\\Projects\\CIS\\reports /reports_dir The reports_dir element is optional and contains a value noting the directory to which reports are saved. This element is equivalent to the -rd command-line option. reports_url ignore_certificate_warnings=\"(true|false\") The reports_url element is optional and contains a value noting the URL to which reports are POST'ed. This element is the equivalent to the -u command-line option. The optional ignore_certificate_warnings attribute, when true , indicates to CIS-CAT that any SSL certificate warnings should be ignored. This attribute is the equivalent to the -ui command-line option. reports_prefix CIS-CAT-DEV /reports_prefix The reports_prefix element is optional and contains a value defining a prefix, essentially naming the reports that are generated by the assessments. When reports are generated, the name of the report is created by concatenating the reports prefix, the report type (such as ARF or OVALResults) and the timestamp of report generation. If this element is not present, the default reports prefix is the assessment target's hostname plus the benchmark's title, such as CIS-CAT-DEV-CIS_Microsoft_Windows_10_Enterprise_Release_1703_Benchmark . Exit Codes A number of scenarios exist which could cause CIS-CAT Pro Assessor to terminate prior to completing its work. Various errors could occur, such as the inability to ingest assessment content, session connectivity problems, etc. The following table describes the set of CIS-CAT Pro Assessor's exit codes: Exit Code Description 0 CIS-CAT Pro Assessor Exited Successfully. 100 Invalid starting directory 101 No valid assessment content was found. 102 CIS-CAT Pro Assessor could not find custom properties file. 103 CIS-CAT Pro Assessor could not parse custom properties. 104 CIS-CAT Pro Assessor could not find custom session properties file. 105 CIS-CAT Pro Assessor could not find the specified OVAL Definitions file. 106 CIS-CAT Pro Assessor could not find the specified OVAL Variables file. 107 CIS-CAT Pro Assessor encountered invalid assessment content. 108 CIS-CAT Pro Assessor could not find Benchmark content. 109 CIS-CAT Pro Assessor encountered an invalid data-stream. 110 CIS-CAT Pro Assessor encountered an invalid checklist. 111 CIS-CAT Pro Assessor encountered an invalid profile. 112 CIS-CAT Pro Assessor encountered an invalid interactive value. 113 CIS-CAT Pro Assessor could not parse an XML file required for assessment. 114 CIS-CAT Pro Assessor could not find an XML file required for assessment. 115 An XML file was parsed but contained an invalid XML Signature. 500 An XML file was parsed but XML Schema validation errors. Troubleshooting and Support During the CIS-CAT Pro Assessor v4 beta testing period, the following support channels may be used: Email the beta testing support team at CIS-CAT@cisecurity.org Start a discussion on the CIS-CAT Pro Assessor v4 Beta Community Once CIS-CAT Pro Assessor v4 is generally available, member support is available through the normal CIS SecureSuite channels: Email support at support@cisecurity.org Start a discussion on the CIS-CAT Discussion Group (login required)","title":"User's Guide"},{"location":"UsersGuide/#cis-cat-pro-assessor-cli-users-guide","text":"NOTE: CIS-CAT Pro Assessor v4 is currently in BETA and this documentation will change as a result of ongoing testing and feedback. Until the official release of CIS-CAT Pro Assessor v4, please consider this document fluid.","title":"CIS-CAT Pro Assessor CLI User's Guide"},{"location":"UsersGuide/#introduction","text":"The CIS-CAT Pro Assessor CLI is a command-line user interface, allowing users to assess target systems against various forms of machine-readable content. CIS-CAT Pro Assessor CLI is designed primarily to assess CIS Benchmark configuration recommendations but can also assess content written in conformance with the Security Content Automation Protocol (SCAP), as well as plain OVAL definition content.","title":"Introduction"},{"location":"UsersGuide/#remote-assessment-capability","text":"Arguably the most important feature to be included in CIS-CAT Pro Assessor v4 is the ability to assess remote endpoints. Providing appropriate connection information allows CIS-CAT Pro Assessor to establish a \"session\", execute commands, run scripts, and perform collection and evaluation for the remote endpoint. For Microsoft Windows endpoints, this \"session\" is established through the use of WinRM. For Unix/Linux and Cisco network device endpoints, CIS-CAT Pro Assessor establishes the \"session\" via SSH. Endpoints to be assessed must be configured appropriately to allow for remote access. Please see the CIS-CAT Pro Assessor Configuration Guide for more information.","title":"Remote Assessment Capability"},{"location":"UsersGuide/#cisco-configuration-assessment","text":"CIS-CAT Pro Assessor v4 includes the capability to assess Cisco networking devices in two ways. Users can choose to connect directly to an online network device, via SSH, using a privileged account and perform evaluations against the current running configuration. New to v4, users now have the ability to export device configurations, specifically the full output of the show tech-support command, to a file, and CIS-CAT Pro Assessor v4 can parse that output and perform the assessment. Specifying the path to the exported configuration file is through the \"session\" configurations. Detailed information on \"sessions\" can be found in the CIS-CAT Pro Assessor Configuration Guide .","title":"Cisco Configuration Assessment"},{"location":"UsersGuide/#deployment","text":"CIS-CAT Pro Assessor CLI is a simple Java-based application and as such, requires a Java Runtime Environment (JRE) at or above version 1.8, in order to execute. A suitable JRE may be installed to the machine on which CIS-CAT is installed, or may be located on a network share. As long as the machine executing the CIS-CAT Pro Assessor CLI application can access a suitable JRE, it may be used to run the tool.","title":"Deployment"},{"location":"UsersGuide/#a-note-on-benchmark-coverage","text":"Many benchmarks which utilized CIS' proprietary Embedded Check Language (ECL) are not yet supported in CIS-CAT Pro Assessor v4, with the exception of the latest Apple OSX versions. Further development will either implement these benchmarks using currently available scripting capabilities, or will be migrated to OVAL when platform coverage is expanded. See the CIS-CAT Pro Assessor Coverage Guide for the most up-to-date information regarding platform coverage.","title":"A note on benchmark coverage"},{"location":"UsersGuide/#using-cis-cat-pro-assessor-cli","text":"Bundled with the application are two script files; a Microsoft Windows batch script, Assessor-CLI.bat and a Unix/Linux shell script, Assessor-CLI.sh . These scripts serve as the entry point to the application. Any examples included in this user's guide will utilize the Microsoft Windows batch script, but usage of the Unix/Linux shell script can be substituted.","title":"Using CIS-CAT Pro Assessor CLI"},{"location":"UsersGuide/#command-line-options","text":"CIS-CAT Pro Assessor CLI can perform a variety of functions related to both benchmark and vulnerability assessments. The myriad command-line options allow for combined usage to initiate these functions.","title":"Command Line Options"},{"location":"UsersGuide/#basic-options","text":"Basic operation of CIS-CAT Pro Assessor CLI allows a user to get help, list available content, or to interactively step through the selection of a benchmark and profile prior to executing an assessment. Short Option Long Option Argument(s) Description -h --help N/A Display CIS-CAT Pro Assessor help output. -l --list N/A List the benchmarks available for assessment. -v --verbose N/A Enable more verbose output when combined with the -l option, specifically displaying the full filepath to the benchmark, for later assessment using the -b option. -i --interactive N/A Execute the Assessor in \"interactive\" mode specifically for benchmark assessments, allowing the user to manually select a benchmark and profile for assessment. Based on the selected benchmark, the user may be required to enter \"interactive values\" which are then used by the assessment engine. -o --definitions N/A Execute the Assessor in \"interactive\" mode specifically for the manual selection and evaluation of OVAL Definitions files, and (optionally) selecting and associating an OVAL Variables file as well. -d --startingDir DIRECTORY Configure the relative root folder from which other options, such as benchmarks, can be found. -cfg --config-xml CONFIGURATION XML FILE Execute CIS-CAT Pro Assessor using configuration information found in the CONFIGURATION XML FILE . This file allows users to override user properties, configure interactive values, setup sessions and outline the various assessments to be performed. See the \"Using a Configuration XML File\" section below for more information and examples regarding the structure and options for the XML configuration file.","title":"Basic Options"},{"location":"UsersGuide/#examples","text":"Simply display the CIS-CAT Pro Assessor help information: Assessor-CLI.bat -h List all available benchmarks: Assessor-CLI.bat -l List all available benchmarks relative to a specific folder: Assessor-CLI.bat -l -d C:\\CIS\\My-Benchmarks List All Available Benchmarks (including path information for use with the -b option) Assessor-CLI.bat -l -v Execute an assessment of a benchmark/data-stream in \"interactive\" mode: Assessor-CLI.bat -i Execute an assessment of a benchmark/data-stream in \"interactive\" mode, selecting a benchmark from a location relative to a specific folder: Assessor-CLI.bat -i -d C:\\CIS\\My-Benchmarks Execute an assessment of an OVAL Definitions file in \"interactive\" mode: Assessor-CLI.bat -i -o Execute an assessment of an OVAL Definitions file in \"interactive\" mode, selecting the definitions file from a location relative to a specific folder: Assessor-CLI.bat -i -o -d C:\\CIS\\My-Benchmarks Execute an assessment or set of assessments using information found in a saved configuration XML file: Assessor-CLI.bat -cfg C:\\CIS\\assessment-configuration.xml","title":"Examples"},{"location":"UsersGuide/#benchmarkdata-stream-collection-options","text":"The benchmark and data-stream collection options provide users the ability to select specific content for assessment. The -b option gives the user the choice to specify the path to either the XCCDF file (containing the Benchmark element) or the Data-stream collection file. Using the -p option, users can select a specific configuration profile to assess, using either the profile's ID or the profile's title/name. Short Option Long Option Argument Description -b --benchmark BMK-OR-DSC Specify either the full filepath to the assessment content or a path relative to the starting directory. The BMK-OR-DSC argument represents either a Benchmark XCCDF file, or the SCAP 1.2-formatted Data-stream Collection file. -dm --data-stream DATA-STREAM Used only when the -b option selects a data-stream-collection document, the -dm option specifies, within the collection, the ID of the data-stream to be assessed. -cl --checklist CHECKLIST Used only in conjunction with the -dm option, the -cl option specifies, within the data-stream, the ID of the checklist (benchmark) to be assessed. -p --profile PROFILE Specify either a profile name, such as Level-1 , or the profile ID, such as xccdf_org.cisecurity.benchmarks_profile_Level_1 . Note that when using the profile name, if any spaces occur, the entire profile name must be wrapped in double-quotes, such as \"Level 2\"","title":"Benchmark/Data-Stream Collection Options"},{"location":"UsersGuide/#examples_1","text":"Execute an assessment against the CIS Microsoft Windows 10 benchmark, using the relative path to the benchmark file, automatically selecting the first profile: Assessor-CLI.bat -b benchmarks\\CIS_Microsoft_Windows_10_Enterprise_Release_1703_Benchmark_v1.3.0-xccdf.xml Execute an assessment against the CIS Microsoft Windows 10 benchmark, using the relative path to the benchmark file, selecting a specific profile by name: Assessor-CLI.bat -b benchmarks\\CIS_Microsoft_Windows_10_Enterprise_Release_1703_Benchmark_v1.3.0-xccdf.xml -p \"Level 1 + BitLocker\" Execute an assessment against the CIS Microsoft Windows 10 benchmarks, using an absolute path to the benchmark file, automatically selecting the first profile: Assessor-CLI.bat -b C:\\CIS\\MyBenchmarks\\CIS_Microsoft_Windows_10_Enterprise_Release_1703_Benchmark_v1.3.0-xccdf.xml Execute an assessment against the CIS Microsoft Windows Server 2016 data-stream collection, using the default first data-stream, default first checklist, and default first profile: Assessor-CLI.bat -b benchmarks\\CIS_Microsoft_Windows_Server_2016_Benchmark_v1.0.0-datastream.xml Execute an assessment against the CIS Microsoft Windows Server 2016 data-stream collection, using a specific data-stream, the default first checklist, and default first profile: Assessor-CLI.bat -b benchmarks\\CIS_Microsoft_Windows_Server_2016_Benchmark_v1.0.0-datastream.xml -dm scap_org.cisecurity_datastream_1.0.0_CIS_Microsoft_Windows_Server_2016_Benchmark Execute an assessment against the CIS Microsoft Windows Server 2016 data-stream collection, using a specific data-stream, a specific checklist, and the default first profile: Assessor-CLI.bat -b benchmarks\\CIS_Microsoft_Windows_Server_2016_Benchmark_v1.0.0-datastream.xml -dm scap_org.cisecurity_datastream_1.0.0_CIS_Microsoft_Windows_Server_2016_Benchmark -cl xccdf_org.cisecurity.benchmarks_benchmark_1.0.0_CIS_Microsoft_Windows_Server_2016_Benchmark Execute an assessment against the CIS Microsoft Windows Server 2016 data-stream collection, using a specific data-stream, a specific checklist and a specific profile: Assessor-CLI.bat -b benchmarks\\CIS_Microsoft_Windows_Server_2016_Benchmark_v1.0.0-datastream.xml -dm scap_org.cisecurity_datastream_1.0.0_CIS_Microsoft_Windows_Server_2016_Benchmark -cl xccdf_org.cisecurity.benchmarks_benchmark_1.0.0_CIS_Microsoft_Windows_Server_2016_Benchmark -p \"Level 1 - Member Server\"","title":"Examples"},{"location":"UsersGuide/#oval-definitions-assessment-options","text":"CIS-CAT Pro Assessor also has the ability to assess OVAL definitions files, such as vulnerability definitions downloaded from the OVAL repository. Using an OVAL Variables file also allows for the injection of \"external\" variable values into the assessment of OVAL definitions content. Short Option Long Option Argument Description -od --oval-definitions OVAL_DEFINITIONS Specify either the full filepath to an OVAL Definitions XML file, or a path relative to the starting directory. -ov --oval-variables OVAL_VARIABLES Only used in conjunction with the -od option, the -ov option specifies either the full filepath to an OVAL Variables XML file, or a path relative to the starting directory.","title":"OVAL Definitions Assessment Options"},{"location":"UsersGuide/#examples_2","text":"Execute an assessment against the Microsoft Windows 10 vulnerability definitions: Assessor-CLI.bat -od vulnerabilities\\microsoft_windows_10.xml Execute an assessment against the Microsoft Windows 10 vulnerability definitions, producing both an OVAL Result XML file, and an HTML report: Assessor-CLI.bat -od vulnerabilities\\microsoft_windows_10.xml -html Execute an assessment against an OVAL Definitions file containing \"external\" variables, using an OVAL Variables file to provide those variable values: Assessor-CLI.bat -od C:\\CIS\\oval_definitions.xml -ov C:\\CIS\\oval_variables.xml Execute an assessment against an OVAL Definitions file containing \"external\" variables, using an OVAL Variables file to provide those variable values, producing both an OVAL Results XML file, and an HTML report: Assessor-CLI.bat -od C:\\CIS\\oval_definitions.xml -ov C:\\CIS\\oval_variables.xml -html","title":"Examples"},{"location":"UsersGuide/#reporting-options","text":"A number of options exist for generating assessment results. When a benchmark or data-stream collection is assessed, the Asset Reporting Format (ARF) results are generated. The ARF report is an XML document containing Asset Information for the endpoint under assessment, the benchmark/data-stream that was assessed, system characteristics, and assessment results. When OVAL Definitions are assessed, an \"OVAL results with system characteristics\" XML document is produced by default. These reports are automatically generated and cannot be disabled. These XML documents are designed to be either uploaded directly to CIS-CAT Pro Dashboard, or transformed into more human-readable HTML, CSV or plain-text documents. The following table summarizes a number of options controlling which reports to generate, naming of reports, and functionality allowing users to upload reports to a URL, such as CIS-CAT Pro Dashboard. Short Option Long Option Argument Description -rd --reports-dir DIRECTORY Configure the report destination folder, allowing users to configure the location to which result reports are written. -rp --report-prefix PREFIX Configure the \"front\" portion of the report name generated by the tool. Every report will automatically be of the format [report-prefix]-[timestamp].[extension] such as CIS-CAT-TEST-Windows10-20171218T173220Z.xml . -html N/A N/A Generate an HTML report. The report name will be of the format [report-prefix]-[timestamp].html -csv N/A N/A Generate a CSV report. The report name will be of the format [report-prefix]-[timestamp].csv -txt N/A N/A Generate a plain text report. The report name will be of the format [report-prefix]-[timestamp].txt -u --url REPORTS-URL Specify a URL to which Assessor results are uploaded, using HTTP(S) POST. -ui --ignore-warnings N/A Indicate that, when uploading results to a URL via the -u option, any SSL certificate warnings should be ignored. -narf --no-arf N/A This option disables the generation of Asset Reporting Format (ARF) XML results. The ARF report is the default report generated by the Assessor. -nrf --no-report-file N/A This option disables generation of a results report file. When utilizing the -u option, Assessor results are uploaded to the supplied URL. In that use-case, report files are generally not needed.","title":"Reporting Options"},{"location":"UsersGuide/#examples_3","text":"Execute CIS-CAT Pro Assessor CLI interactively, generating both an Asset Reporting Format result (by default) and an HTML report, saving them to the default reports folder: Assessor-CLI.bat -i -html Execute an assessment against the CIS Microsoft Windows 10 benchmark, using the relative path to the benchmark file, automatically selecting the first profile. Generate both the Asset Reporting Format (ARF) by default and an HTML report. Save the reports to a specific reports folder: Assessor-CLI.bat -b benchmarks\\CIS_Microsoft_Windows_10_Enterprise_Release_1703_Benchmark_v1.3.0-xccdf.xml -html -rd C:\\CIS\\custom\\reports Execute an assessment against the CIS Microsoft Windows 10 benchmark, using the relative path to the benchmark file, automatically selecting the first profile. Generate both the Asset Reporting Format (ARF) by default and an HTML report. Save the reports to the default reports folder, but name the reports in a custom format: Assessor-CLI.bat -b benchmarks\\CIS_Microsoft_Windows_10_Enterprise_Release_1703_Benchmark_v1.3.0-xccdf.xml -html -rp \"CCPA-Windows10\" Execute an assessment against the CIS Microsoft Windows 10 benchmark, using the relative path to the benchmark file, automatically selecting the first profile. Configure the application to not generate any physical report files, but to upload the results to CIS-CAT Pro Dashboard, ignoring any SSL certificate warnings: Assessor-CLI.bat -b benchmarks\\CIS_Microsoft_Windows_10_Enterprise_Release_1703_Benchmark_v1.3.0-xccdf.xml -nrf -u https://ccpd.example.org/CCPD/api/reports/upload -ui","title":"Examples"},{"location":"UsersGuide/#miscellaneous-options","text":"Short Option Long Option Argument Description -vdd --vulnerability-definitions N/A Download the latest supported vulnerability definitions. See the CIS-CAT Pro Assessor Coverage Guide for the most up-to-date information regarding vulnerability definitions platform coverage. Vulnerability definitions files are saved into the application's vulnerabilities folder, i.e. C:\\CIS\\Assessor-CLI\\vulnerabilities . -sessions --sessions SESSIONS.PROPERTIES The -sessions option allows users to configure multiple endpoints for assessment of a benchmark. The sessions.properties file configures CIS-CAT Pro Assessor for the assessment of remote endpoints by specifying remote hosts, ports, and credentials which the application will use for connection, collection and evaluation of benchmark recommendations and/or vulnerabilities. See \"Remote Assessment Capability\" below for more information. If no sessions.properties file exists or no connections are configured in the file, CIS-CAT Pro Assessor CLI will assess the local machine. -props --properties PROPERTIES-FILE The CIS-CAT Pro Assessor CLI user properties file defaults many runtime properties used during the assessment process. These properties may be customized per assessment or per endpoint, by creating individual properties files, and specifying either the full filepath or a path relative to the working directory. If this option is not specified, CIS-CAT Pro Assessor CLI will load a default properties file named assessor-cli.properties located in the config folder of the application installation. -D N/A Property=Value Instead of creating a new properties file for unique assessments, individual user properties may be specified using the -D option together with a property=value pair. This allows an assessment to only override specific user properties when only a small number differ from the defaults. -test --test N/A The -test option allows the user to perform connection tests on any sessions configured to execute during the assessments. These sessions may be loaded from a configuration XML file ( -cfg ) or from a sessions.properties file ( -sessions ). When specified, connectivity tests are performed and reported to the user on the CIS-CAT Pro Assessor console. Once completed, CIS-CAT Pro Assessor exits. When the -test option is supplied, no assessments take place; only the connectivity tests. -q --quiet N/A Enable the Assessor to execute in \"quiet mode\", causing the suppression of any assessment status information from being written to the console.","title":"Miscellaneous Options"},{"location":"UsersGuide/#examples_4","text":"Download the latest vulnerability definitions: Assessor-CLI.bat -vdd Download the latest vulnerability definitions when using an HTTPS Proxy: Assessor-CLI.bat -vdd -D https.proxyHost=PROXY_HOSTNAME_OR_IP -D https.proxyPort=PROXY_PORT Download the latest vulnerability definitions when using an HTTP Proxy: Assessor-CLI.bat -vdd -D http.proxyHost=PROXY_HOSTNAME_OR_IP -D http.proxyPort=PROXY_PORT Execute a vulnerability assessment for the Microsoft Windows Server 2012 R2 platform, producing both an OVAL Result XML file, and an HTML report: Assessor-CLI.bat -od vulnerabilities\\microsoft_windows_server_2012_r2.xml -html Execute an assessment against the CIS Microsoft Windows 10 benchmark, using the relative path to the benchmark file, automatically selecting the first profile, assessing a number of remote machines, configured in a specific session configuration file: Assessor-CLI.bat -b benchmarks\\CIS_Microsoft_Windows_10_Enterprise_Release_1703_Benchmark_v1.3.0-xccdf.xml -sessions C:\\CIS\\sessions\\windows_10_machines.properties Execute an assessment against the CIS Oracle Database 11g R2 benchmark, selecting the Windows Server Host OS profile, and configuring the required \"interactive\" values: Assessor-CLI.bat -b benchmarks\\CIS_Oracle_Database_11g_R2_Benchmark_v2.2.0-xccdf.xml -p \"Level 1 - Windows Server Host OS\" -D xccdf_org.cisecurity_value_jdbc.url=jdbc:oracle:thin:user/s3cr3t@DBHOST:1521:devdb -D xccdf_org.cisecurity_value_listener.ora=C:\\product\\oracle\\network\\admin\\listener.ora Using a customized properties file defining session connections, test the connectivity of each session and exit: Assessor-CLI.bat -sessions config\\test-sessions.properties -test Execute the Assessor, against the CIS Microsoft Windows 10 benchmark, in \"quiet mode\" Assessor-CLI.bat -b benchmarks\\CIS_Microsoft_Windows_10_Enterprise_Release_1703_Benchmark_v1.3.0-xccdf.xml -q","title":"Examples"},{"location":"UsersGuide/#configuring-interactive-values","text":"A number of benchmarks supported by/bundled with CIS-CAT Pro Assessor require manual interaction by the user in order to configure specific values used during the assessment. These \"interactive values\" will be presented to the user during a manual execution of the assessment, but will block the completion of the assessment if it is being executed off-hours, or as part of an automated script. CIS-CAT Pro Assessor provides a mechanism for these \"interactive values\" to be configured using a properties file, thus removing the burden of entering these values manually. This configuration requires knowledge of the value's id attribute within the benchmark or data-stream collection component. The CIS-CAT Pro Assessor Coverage Guide provides a listing, for each applicable benchmark, for any \"interactive value\" id attributes. Once known, a user can modify the assessor-cli.properties file to specify the value: xccdf_org.cisecurity_value_jdbc.url=jdbc:oracle:thin:system/manager@dbhost:1521:orcl When CIS-CAT Pro Assessor executes, the program will (by default) attempt to load properties contained in the config\\assessor-cli.properties . A second method to configure \"interactive values\" is to utilize the -D Property=Value command-line option. This allows the user to configure a single property at a time when executing, therefore eliminating the potential need for multiple properties files. Configuring this option on the command-line is straightforward, where the property name is the id attribute of the \"interactive value\" and the property value is configured: Assessor-CLI.bat -b benchmarks\\CIS_Oracle_Database_11g_R2_Benchmark_v2.2.0-xccdf.xml -p \"Level 1 - Windows Server Host OS\" -D xccdf_org.cisecurity_value_jdbc.url=jdbc:oracle:thin:user/s3cr3t@DBHOST:1521:devdb","title":"Configuring Interactive Values"},{"location":"UsersGuide/#using-a-configuration-xml-file","text":"CIS-CAT Pro Assessor can be executed using the -cfg option, and specifying a configuration XML file. This XML file allows user to configure sessions, assessments, interactive values, user properties, and reporting options all in a single file. This configuration XML file essentially allows for multiple benchmark assessments against multiple endpoints both local and/or remote. An XML schema is included in the CIS-CAT Pro Assessor CLI bundle, along with a sample configuration file.","title":"Using a Configuration XML File"},{"location":"UsersGuide/#configuration-xml-elements","text":"The root element of the configuration XML file is configuration , and utilizes a default namespace URI of http://cisecurity.org/ccpa/config . This namespace URI must be specified or else validation of the configuration XML file will fail. The root of any XML configuration file should appear as follows: configuration xmlns=\"http://cisecurity.org/ccpa/config\" All other elements must be contained within the configuration element. The following sections describe the elements that are available for configuration through the XML file:","title":"Configuration XML Elements"},{"location":"UsersGuide/#cis-cat-pro-assessor-starting-directory","text":"starting_dir C:\\Projects\\CIS-CAT\\Assessor-CLI /starting_dir The starting_dir element is optional and contains a value noting the base directory from which any relative paths are specified (such as the location of an XCCDF benchmark). This element is the equivalent of the -d command-line option. If this element is not present in the configuration file, the default starting directory, the folder in which CIS-CAT Pro Assessor is installed, is used.","title":"CIS-CAT Pro Assessor \"starting directory\""},{"location":"UsersGuide/#vulnerability-definitions-download","text":"vulnerability_definitions download=\"(true|false)\"/ The vulnerability_definitions element contains a single attribute, download . If this attribute's value is true , CIS-CAT Pro Assessor will download the latest vulnerability definitions. This element/attribute is equivalent to the -vdd command-line option. If this element is not present in the configuration file, or the download attribute is set to false , vulnerability definitions will not be downloaded.","title":"Vulnerability Definitions Download"},{"location":"UsersGuide/#sessions","text":"The sessions element configures each individual connection to either the local host or a remote endpoint. An attribute of the sessions element, test indicates whether this configuration file is meant to test the connectivity of each session only. When the test attribute is true , connectivity tests will take place, and CIS-CAT Pro Assessor will then exit. No other assessment processing will take place. !-- Session configurations referenced by the assessments -- sessions test=\"(true|false)\" !-- A \"connection\" to the local host -- session id=\"local\" type local /type tmp_path C:\\Temp /tmp_path /session !-- A connection to a remote Ubuntu instance using a private key file -- session id=\"aws-ubuntu\" type ssh /type host 11.22.33.44 /host port 22 /port user ubuntu /user identity C:\\Path\\To\\aws-ubuntu.ppk /identity tmp_path /path/to/temp/folder /tmp_path /session !-- A connection to a remote CentOS instance using a private key file secured with a passphrase -- session id=\"aws-centos\" type ssh /type host 1.2.3.4 /host port 22 /port user centos /user identity C:\\Path\\To\\aws-centos.ppk /identity identity_passphrase P@55phr@s3! /identity_passphrase tmp_path /path/to/temp/folder /tmp_path /session !-- A connection to a remote Windows instance using credentials -- session id=\"aws-2012r2\" type windows /type host AWS-WIN2012R2-AMI /host port 5986 /port user Administrator /user credentials P@ssw0rd12345 /credentials /session !-- A connection to a Cisco IOS device, using a private key file -- session id=\"cisco-ios1\" type ios /type host 55.66.77.88 /host port 22 /port user ciscoprivd /user identity C:\\Path\\To\\cisco-ios-private-key.ppk /identity enable_password 3n@bl3mePlz /enable_password /session /sessions Each session consists of a number of elements configuring the connection to the target endpoint: type : The session type indicates a \"flavor\" of the connection to the endpoint being assessed. A number of options exist for the type value, as noted in the CIS-CAT Pro Assessor Configuration Guide . local : The \"local\" session type indicates that the assessment(s) will be performed in a host-based manner. No further session information is required when using a \"local\" session. ssh : The \"ssh\" session type indicates the connection is to a remote Unix/Linux/Mac endpoint. This session type allows CIS-CAT Pro Assessor to utilize the host , port , user , and either credentials and/or identity (and optionally an identity_passphrase ) to create a SSH connection to the endpoint and use that SSH connection to execute the assessment. windows : The \"windows\" session type indicates (obviously) a connection to a remote Microsoft Windows endpoint. This session type allows CIS-CAT Pro Assessor to utilize the host , port , user , credentials to initiate a WinRM connection to the remote endpoint. ios : The \"ios\" session type indicates a connection to a remote Cisco IOS device, such as a router or switch. This session type allows CIS-CAT Pro Assessor to utilize the host , port , user , and either credentials and/or identity (and optionally an identity_passphrase ) to create a SSH connection to the endpoint and use that SSH connection to execute the assessment. host : The \"host\" element value is either the hostname or IP address of the endpoint to which this session will connect/assess. port : The \"port\" element value is the port number on which communication takes place. For ssh or ios connections, the default value for port is 22. For windows sessions, the default value is 5986. user : The \"user\" element value specifies the username used to log on to the remote endpoint. For ssh sessions, this user should be either root or a username with the ability to sudo , in order to elevate privileges to execute the required commands. For windows sessions, the user must be either an Administrator or a member of the Administrators group. For ios sessions, the user must be privileged and able to enter into \"enable\" mode on that device, using the enable_password value below. credentials : The \"credentials\" element identifies the user's password for logging on to the remote endpoint. Note that this XML file will then be storing users and passwords for remote endpoints, and should thus be secured as much as possible on the machine hosting CIS-CAT Pro Assessor. When the session type is either ssh or ios , the credentials element can be bypassed by logging into the remote endpoint using a private key file, the path of which is configured in the identity element. If a private key is used for authentication, the credentials element can either be left out of the session configuration, or included for use when commands must be executed with elevated privileges using sudo , and the credentials are required for that user. identity : The identity element specifies the full filepath to a private key file to be used for authenticating the user to the remote endpoint. When configuring a session , the identity may require the specification of the identity_passphrase in order for authentication to complete successfully. Note that for windows sessions, private key authentication is not currently supported. identity_passphrase : The identity_passphrase element contains credentials required to complete authentication using the private key specified in the identity element. enable_password : When authenticating a privileged user for ios sessions, the enable_password is mandatory. This element specifies the credentials which allow the privileged user to enter \"enable\" mode on the Cisco IOS device. tmp_path : Configure a custom \"temp\" directory location for use on the target endpoint. By default, the Assessor will use the \"temp\" folder location defined for that operating system, such as /tmp or C:\\Windows\\Temp . If a different folder should be used, for example because the /tmp partition is configured with -noexec , the tmp_path element should be included.","title":"Sessions"},{"location":"UsersGuide/#assessments","text":"The assessments element configures which assessment content will be evaluated, against which session that content will be assessed, any User properties specific to that assessment, and/or any \"interactive\" values to be applied to that assessment. assessments !-- XCCDF COLLECTIONS -- benchmark xccdf=\"benchmarks\\CIS_Ubuntu_Linux_16.04_LTS_Benchmark_v1.0.0-xccdf.xml\" profile=\"Level 1 - Workstation\" session-ref=\"aws-ubuntu\"/ benchmark xccdf=\"benchmarks\\CIS_Ubuntu_Linux_16.04_LTS_Benchmark_v1.0.0-xccdf.xml\" profile=\"Level 1 - Server\" session-ref=\"aws-ubuntu\"/ benchmark xccdf=\"benchmarks\\CIS_Microsoft_Windows_Server_2012_R2_Benchmark_v2.2.1-xccdf.xml\" profile=\"Level 1 - Member Server\" session-ref=\"aws-2012r2\" properties property name=\"ignore.platform.mismatch\" true /property /properties /benchmark benchmark xccdf=\"benchmarks\\CIS_Oracle_Database_11g_R2_Benchmark_v2.2.0-xccdf.xml\" profile=\"Level 1\" session-ref=\"aws-ubuntu\" interactive_values value id=\"xccdf_org.cisecurity_value_jdbc.url\" jdbc:oracle:thin:sys/passw0rd1@DB-SERVER:1521:ORCL /value value id=\"xccdf_org.cisecurity_value_listener.ora\" /opt/oracle/product/oracle11g/network/admin/listener.ora /value /interactive_values /benchmark !-- DATA-STREAM COLLECTIONS -- data-stream-collection collection=\"dsc-id\" data-stream=\"ds-id\" checklist=\"benchmark-id\" profile=\"profile-id-or-name\" session-ref=\"local\"/ !-- OVAL DEFINITIONS COLLECTIONS -- oval_definitions definitions=\"vulnerabilities\\microsoft_windows_10.xml\" session-ref=\"local\"/ oval_definitions definitions=\"definitions\\defs.xml\" variables=\"definitions\\vars.xml\" session-ref=\"local\"/ /assessments A number of elements may be configured, allowing various assessments against a number of different sessions: Assess an XCCDF Benchmark , selecting the first Profile : benchmark xccdf=\"benchmarks\\CIS_Ubuntu_Linux_16.04_LTS_Benchmark_v1.0.0-xccdf.xml\" session-ref=\"aws-ubuntu\"/ xccdf : The \"xccdf\" attribute defines the path (relative to the starting_dir or absolute) to the XCCDF file being assessed. session-ref : The \"session-ref\" attribute specifies the id of a session configured in the sessions configuration, described above. Assess an XCCDF Benchmark , selecting a named Profile : benchmark xccdf=\"benchmarks\\CIS_Ubuntu_Linux_16.04_LTS_Benchmark_v1.0.0-xccdf.xml\" profile=\"Level 1 Workstation\" session-ref=\"aws-ubuntu\"/ xccdf : The \"xccdf\" attribute defines the path (relative to the starting_dir or absolute) to the XCCDF file being assessed. profile : The \"profile\" attribute defines the configuration Profile, within the XCCDF, selected for assessment. The value of this attribute may be either the Profile title or id specified in the Benchmark XCCDF. session-ref : The \"session-ref\" attribute specifies the id of a session configured in the sessions configuration, described above. Assess an XCCDF Benchmark , selecting a named Profile, and configuring specific assessment properties : benchmark xccdf=\"benchmarks\\CIS_Microsoft_Windows_Server_2012_R2_Benchmark_v2.2.1-xccdf.xml\" profile=\"Level 1 Member Server\" session-ref=\"aws-2012r2\" properties property name=\"ignore.platform.mismatch\" true /property /properties /benchmark xccdf : The \"xccdf\" attribute defines the path (relative to the starting_dir or absolute) to the XCCDF file being assessed. profile : The \"profile\" attribute defines the configuration Profile, within the XCCDF, selected for assessment. The value of this attribute may be either the Profile title or id specified in the Benchmark XCCDF. session-ref : The \"session-ref\" attribute specifies the id of a session configured in the sessions configuration, described above. properties : The \"properties\" element serves as a container for individual property elements. A properties element must contain 1..n property element(s). property : A \"property\" defines a name/value pair, configuring a single user property named by the value of the name attribute. The value of the property is the content of the element. An individual property is the equivalent of using the -D name=value command-line option, or a property defined in the \"assessor-cli.properties\" file, located in the config folder. Assess an XCCDF Benchmark , selecting a named Profile, configuring specific values normally requested from the user : benchmark xccdf=\"benchmarks\\CIS_Oracle_Database_11g_R2_Benchmark_v2.2.0-xccdf.xml\" profile=\"Level 1\" session-ref=\"aws-ubuntu\" interactive_values value id=\"xccdf_org.cisecurity_value_jdbc.url\" jdbc:oracle:thin:sys/passw0rd1@DB-SERVER:1521:ORCL /value value id=\"xccdf_org.cisecurity_value_listener.ora\" /opt/oracle/product/oracle11g/network/admin/listener.ora /value /interactive_values /benchmark xccdf : The \"xccdf\" attribute defines the path (relative to the starting_dir or absolute) to the XCCDF file being assessed. profile : The \"profile\" attribute defines the configuration Profile, within the XCCDF, selected for assessment. The value of this attribute may be either the Profile title or id specified in the Benchmark XCCDF. session-ref : The \"session-ref\" attribute specifies the id of a session configured in the sessions configuration, described above. interactive_values : The \"interactive_values\" element serves as a container for individual value elements. An interactive_values element must contain 1..n value element(s). value : A \"value\" defines an id/value pair, configuring a single interactive value identified by the id attribute. This id attribute should match the id of a Value element in the XCCDF that is noted as interactive=\"true\" . The value of the value is the content of the element. An individual value is the equivalent of using the -D name=value command-line option, or a property defined in the \"assessor-cli.properties\" file, located in the config folder. Assess a SCAP data-stream-collection , selecting the first data-stream, checklist, and profile : data-stream-collection collection=\"collections\\collection.xml\" session-ref=\"local\"/ collection : The \"collection\" attribute defines the path (relative to the starting_dir or absolute) to the SCAP 1.2 data-stream collection file being assessed. session-ref : The \"session-ref\" attribute specifies the id of a session configured in the sessions configuration, described above. Assess a SCAP data-stream-collection , selecting a named data-stream, the first checklist, and first profile : data-stream-collection collection=\"collections\\collection.xml\" data-stream=\"ds-id\" checklist=\"benchmark-id\" profile=\"profile-id-or-name\" session-ref=\"local\"/ collection : The \"collection\" attribute defines the path (relative to the starting_dir or absolute) to the SCAP 1.2 data-stream collection file being assessed. data-stream : The \"data-stream\" attribute specifies the id of the data-stream , contained in the collection, to be selected for assessment. session-ref : The \"session-ref\" attribute specifies the id of a session configured in the sessions configuration, described above. Assess a SCAP data-stream-collection , selecting a named data-stream, a named checklist, and the first profile : data-stream-collection collection=\"collections\\collection.xml\" data-stream=\"ds-id\" checklist=\"benchmark-id\" profile=\"profile-id-or-name\" session-ref=\"local\"/ collection : The \"collection\" attribute defines the path (relative to the starting_dir or absolute) to the SCAP 1.2 data-stream collection file being assessed. data-stream : The \"data-stream\" attribute specifies the id of the data-stream , contained in the collection, to be selected for assessment. checklist : The \"checklist\" attribute specifies the id of the checklist to be assessed. A checklist is a component in the data-stream collection representing an XCCDF Benchmark . session-ref : The \"session-ref\" attribute specifies the id of a session configured in the sessions configuration, described above. Assess a SCAP data-stream-collection , selecting a named data-stream, a named checklist, and a named profile : data-stream-collection collection=\"collections\\collection.xml\" data-stream=\"ds-id\" checklist=\"benchmark-id\" profile=\"profile-id-or-name\" session-ref=\"local\"/ collection : The \"collection\" attribute defines the path (relative to the starting_dir or absolute) to the SCAP 1.2 data-stream collection file being assessed. data-stream : The \"data-stream\" attribute specifies the id of the data-stream , contained in the collection, to be selected for assessment. checklist : The \"checklist\" attribute specifies the id of the checklist to be assessed. A checklist is a component in the data-stream collection representing an XCCDF Benchmark . profile : The \"profile\" attribute defines the configuration Profile, within the checklist, selected for assessment. The value of this attribute may be either the Profile title or id specified in the Benchmark XCCDF. session-ref : The \"session-ref\" attribute specifies the id of a session configured in the sessions configuration, described above. Assess an oval_definitions file that does not include an oval_variables file : oval_definitions definitions=\"vulnerabilities\\microsoft_windows_10.xml\" session-ref=\"local\"/ definitions : The \"definitions\" attribute defines the path (relative to the starting_dir or absolute) to the OVAL Definitions file being assessed. Assess an oval_definitions file that includes an oval_variables file : oval_definitions definitions=\"definitions\\defs.xml\" variables=\"definitions\\vars.xml\" session-ref=\"local\"/ definitions : The \"definitions\" attribute defines the path (relative to the starting_dir or absolute) to the OVAL Definitions file being assessed. variables : The \"variables\" attribute defines the path (relative to the starting_dir or absolute) to the OVAL Variables file used in the assessment.","title":"Assessments"},{"location":"UsersGuide/#report-output-options","text":"The reports element contains a number of attributes controlling the output report formats, and sub-elements controlling report output directory, POST URL, and report naming. The html attribute value controls the generation of HTML reports, the csv attribute controls the generation of CSV reports, and the txt attribute controls the generation of plain-text reports. The no-arf attribute, when true , disables the generation of the Asset Reporting Format XML results. The no-report-file attribute, when true , overrides the other 3 attributes and disables the generation of any report files. Setting this attribute to true is intended to be used in conjunction with the reports_url element, which identifies a URL to which report output should be POST'ed. If the reports are POST'ed to the URL, they may not need to be generated and saved in file format. !-- Customize the folder to which CIS-CAT reports are saved. If not present, CIS-CAT will use the default reports location. -- reports_dir C:\\Projects\\CIS\\reports /reports_dir !-- POST the Asset Reporting Format or OVAL Results XML to a URL, ignoring SSL certificate warnings if specified -- reports_url ignore_certificate_warnings=\"true\" https://example.cisecurity.org/CCPD/api/reports/upload /reports_url !-- Override the default report name. Timestamp information will always be appended to the report_prefix -- reports_prefix CIS-CAT-DEV /reports_prefix /reports Various sub-elements are available to configure the destination folder for report files to be saved, URL's to which reports can be uploaded, and naming of reports: reports_dir C:\\Projects\\CIS\\reports /reports_dir The reports_dir element is optional and contains a value noting the directory to which reports are saved. This element is equivalent to the -rd command-line option. reports_url ignore_certificate_warnings=\"(true|false\") The reports_url element is optional and contains a value noting the URL to which reports are POST'ed. This element is the equivalent to the -u command-line option. The optional ignore_certificate_warnings attribute, when true , indicates to CIS-CAT that any SSL certificate warnings should be ignored. This attribute is the equivalent to the -ui command-line option. reports_prefix CIS-CAT-DEV /reports_prefix The reports_prefix element is optional and contains a value defining a prefix, essentially naming the reports that are generated by the assessments. When reports are generated, the name of the report is created by concatenating the reports prefix, the report type (such as ARF or OVALResults) and the timestamp of report generation. If this element is not present, the default reports prefix is the assessment target's hostname plus the benchmark's title, such as CIS-CAT-DEV-CIS_Microsoft_Windows_10_Enterprise_Release_1703_Benchmark .","title":"Report Output Options"},{"location":"UsersGuide/#exit-codes","text":"A number of scenarios exist which could cause CIS-CAT Pro Assessor to terminate prior to completing its work. Various errors could occur, such as the inability to ingest assessment content, session connectivity problems, etc. The following table describes the set of CIS-CAT Pro Assessor's exit codes: Exit Code Description 0 CIS-CAT Pro Assessor Exited Successfully. 100 Invalid starting directory 101 No valid assessment content was found. 102 CIS-CAT Pro Assessor could not find custom properties file. 103 CIS-CAT Pro Assessor could not parse custom properties. 104 CIS-CAT Pro Assessor could not find custom session properties file. 105 CIS-CAT Pro Assessor could not find the specified OVAL Definitions file. 106 CIS-CAT Pro Assessor could not find the specified OVAL Variables file. 107 CIS-CAT Pro Assessor encountered invalid assessment content. 108 CIS-CAT Pro Assessor could not find Benchmark content. 109 CIS-CAT Pro Assessor encountered an invalid data-stream. 110 CIS-CAT Pro Assessor encountered an invalid checklist. 111 CIS-CAT Pro Assessor encountered an invalid profile. 112 CIS-CAT Pro Assessor encountered an invalid interactive value. 113 CIS-CAT Pro Assessor could not parse an XML file required for assessment. 114 CIS-CAT Pro Assessor could not find an XML file required for assessment. 115 An XML file was parsed but contained an invalid XML Signature. 500 An XML file was parsed but XML Schema validation errors.","title":"Exit Codes"},{"location":"UsersGuide/#troubleshooting-and-support","text":"During the CIS-CAT Pro Assessor v4 beta testing period, the following support channels may be used: Email the beta testing support team at CIS-CAT@cisecurity.org Start a discussion on the CIS-CAT Pro Assessor v4 Beta Community Once CIS-CAT Pro Assessor v4 is generally available, member support is available through the normal CIS SecureSuite channels: Email support at support@cisecurity.org Start a discussion on the CIS-CAT Discussion Group (login required)","title":"Troubleshooting and Support"}]}